gplink-2.0.0_beta1 (Jun 21 2017)
Listing File Generated: 2017-6-21  15:27:42
 
 
Address  Value    Disassembly              Source
-------  -----    -----------              ------
                                           
                                           
                                           ;************************************************
                                           ;仿真与烧板子有四处差异，记得修改
                                           ;标定准
                                           ;**************************************************
                                           
                                                           ;#include  "mc32p7212.inc"
                                           
                                           ;==========================================================================
                                           ;                               mc33p94
                                           ;       Revision History
                                           ;
                                           ;==========================================================================
                                           
                                           ;Rev:   Date:    Reason:
                                           
                                           ;1.00   12/06/21 Initial Release
                                           
                                           ;==========================================================================
                                           ;
                                           ;       Verify Processor
                                           ;
                                           ;==========================================================================
                                           ;
                                           ;       Register Definitions
                                           ;
                                           ;==========================================================================
                                           
                                           ;W 	   	EQU        	H'0000'
                                           ;F 	   	EQU        	H'0001'
                                           
                                           ;----- Register Files------------------------------------------------------
                                           cblock 	0x180
                                           INDF0
                                           INDF1
                                           INDF2
                                           HIBYTE
                                           FSR0
                                           FSR1
                                           PCL
                                           PFALG
                                           ;----0x188
                                           MCR
                                           INDF3
                                           INTE0
                                           INTF0
                                           INVALID_ADDR0
                                           INVALID_ADDR1
                                           INVALID_ADDR2
                                           INVALID_ADDR3
                                           ;----0x190
                                           IOP0
                                           OEP0
                                           PUP0
                                           INVALID_ADDR4
                                           IOP1
                                           OEP1
                                           PUP1
                                           INVALID_ADDR5
                                           ;-----0x198
                                           OEP2
                                           IOP2
                                           PUP2
                                           INVALID_ADDR6
                                           OEP3
                                           IOP3
                                           PUP3
                                           INVALID_ADDR7
                                           ;-----0x1a0
                                           T0CR
                                           T0CNT
                                           T0LOAD
                                           T0DATA
                                           T1CR
                                           T1CNT
                                           T1LOAD
                                           T1DATA
                                           ;-----0x1a8
                                           LXTCR
                                           HIRCCR0
                                           HIRCCR1
                                           HIRCCR2
                                           INVALID_ADDR14
                                           PUMP
                                           OSCM
                                           LVDCR
                                           ;-----0x1b0
                                           ADCR0
                                           ADCR1
                                           ADCR2
                                           TPSC
                                           ADRH
                                           ADRM
                                           ADRL
                                           INVALID_ADDRff
                                           ;----0x1b8
                                           LCDCR0
                                           LCDCR1
                                           LCDIOS1
                                           LCDIOS2
                                           INVALID_ADDR15
                                           INVALID_ADDR16
                                           INVALID_ADDR17
                                           INVALID_ADDR18
                                           INVALID_ADDR19
                                           INVALID_ADDR20
                                           ;----0x1c0
                                           LCDDS0
                                           LCDDS1
                                           LCDDS2
                                           LCDDS3
                                           LCDDS4
                                           LCDDS5
                                           LCDDS6
                                           LCDDS7
                                           ;----0x1c8
                                           LCDDS8
                                           LCDDS9
                                           LCDDSa
                                           LCDDSb
                                           INVALID_ADDR21
                                           INVALID_ADDR22
                                           INVALID_ADDR23
                                           INVALID_ADDR24
                                           endc
                                           
                                           OSCCAL          equ        	0x1f3
                                           
                                           #define         STATUS          PFALG
                                           #define         INDF            INDF0
                                           #define         FSR             FSR0
                                           #define         P0HCON          PUP0
                                           #define         P1HCON          PUP1
                                           #define         INTECON         INTE0
                                           #define         INTEFLAG        INTF0
                                           #define         LCDDS10         LCDDSa
                                           #define         LCDDS11         LCDDSb
                                           #define         LCDDS12         LCDDSc
                                           #define         LCDDS13         LCDDSd
                                           #define         LCDDS14         LCDDSe
                                           #define         LCDDS15         LCDDSf
                                           
                                           ;----- STATUS Bits --------------------------
                                           #define	   	Z  	   	PFALG,2
                                           #define	   	DC 	   	PFALG,1
                                           #define	   	C  	   	PFALG,0
                                           
                                           ;-------------------------------------------
                                           ; Status register bit map
                                           
                                           ;----- MCR Bits --------------------------
                                           #define	   	GIE	   	MCR,7
                                           
                                           ;-----  P2HCON Bits -----------------------
                                           #define	   	P20PH      	P2HCON,0
                                           #define	   	P21PH      	P2HCON,1
                                           #define	   	P22PH      	P2HCON,2
                                           #define    	P23PH      	P2HCON,3
                                           #define    	P24PH      	P2HCON,4
                                           #define    	P25PH      	P2HCON,5
                                           #define    	P26PH      	P2HCON,6
                                           #define    	P27PH      	P2HCON,7
                                           ;----- INTECON Bits --------------------------
                                           #define    	INTE       	INTECON
                                           #define    	ADIE       	INTECON,6
                                           #define    	KBIE       	INTECON,4
                                           #define    	INT1IE     	INTECON,3
                                           #define    	INT0IE     	INTECON,2
                                           #define    	T1IE       	INTECON,1
                                           #define    	T0IE       	INTECON,0
                                           ;----- INTEFLAG Bits --------------------------
                                           #define    	INTF       	INTEFLAG
                                           #define    	ADIF       	INTF,6
                                           #define    	KBIF       	INTF,4
                                           #define    	INT1IF     	INTF,3
                                           #define    	INT0IF     	INTF,2
                                           #define    	T1IF       	INTF,1
                                           #define    	T0IF       	INTF,0
                                           ;----- UCR Bits--------------------------
                                           #define    	OPEN       	UCR,4
                                           #define    	EPEN       	UCR,3
                                           #define    	UARTEN     	UCR,2
                                           ;----- UFR ----------------------
                                           #define    	FREF       	UFR,7
                                           #define    	PAEF       	UFR,6
                                           #define    	OVEF       	UFR,5
                                           #define    	TSEF       	UFR,4
                                           #define    	RDAF       	UFR,1
                                           #define    	TREF       	UFR,0
                                           ;---- ADCR0 Bits -----------------
                                           #define    	ADCKS_16       	0<<1       	; Fcpu/16
                                           #define    	ADCKS_8        	1<<1       	; Fcpu/8
                                           #define    	ADCKS_4        	2<<1       	; Fcpu/4
                                           #define    	ADCKS_2        	2<<1       	; Fcpu/2
                                           #define    	ADCHS_0        	0<<4       	; AN0
                                           #define    	ADCHS_1        	1<<4       	; AN1
                                           #define    	ADCHS_2        	2<<4       	; AN2
                                           #define    	ADCHS_3        	3<<4       	; AN3
                                           #define    	ADCHS_4        	4<<4       	; AN4
                                           #define    	ADCHS_5        	5<<4       	; AN5
                                           #define    	ADCHS_6        	6<<4       	; AN6
                                           #define    	ADEN       	ADCR0,0
                                           #define    	ADEOC      	ADCR0,3
                                           ;---- ADCR1 Bits -----------------
                                           #define    	ADV_ADD        	3          	; VDD
                                           #define    	ADV_4V         	2          	; 4V
                                           #define    	ADV_3V         	1          	; 3V
                                           #define    	ADV_2V         	0          	; 2V
                                           #define    	ADV_EX         	4          	; 外部参考电压
                                           ;----- LCDCR0 Bits --------------------------
                                           #define    	LCDEN      	LCDCR0,7
                                           #define    	VLCDS      	LCDCR0,3
                                           ;----- T0CR  Bits ----------------
                                           #define    	TC0EN      	T0CR,7
                                           #define    	PWM0OUT    	T0CR,6
                                           #define    	BUZ0OUT    	T0CR,5
                                           ;----- T1CR  Bits ----------------
                                           #define    	TC1EN      	T1CR,7
                                           #define    	PWM1OUT    	T1CR,6
                                           #define    	BUZ1OUT    	T1CR,5
                                           ;----- OSCM  Bits ----------------
                                           #define    	STBL       	OSCM,5
                                           #define    	STBH       	OSCM,4
                                           #define    	CLKS       	OSCM,2
                                           #define    	LFEN       	OSCM,1
                                           #define    	HFEN       	OSCM,0
                                           ;-----  POWCR Bits -------
                                           #define    	LDOEN      	POWCR,7
                                           #define    	ENB        	POWCR,6
                                           ;-----  LVDCR Bits -------
                                           #define    	LVD        	PLVDCR,7
                                           #define    	LVDS       	PLVDCR,6
                                           ;***********DDR1 DDR2 **********
                                           #define    	DDR10      	DDR1,0
                                           #define    	DDR11      	DDR1,1
                                           #define    	DDR12      	DDR1,2
                                           #define    	DDR13      	DDR1,3
                                           
                                           #define    	DDR20      	DDR2,0
                                           #define    	DDR21      	DDR2,1
                                           #define    	DDR22      	DDR2,2
                                           #define    	DDR23      	DDR2,3
                                           #define    	DDR24      	DDR2,4
                                           #define    	DDR25      	DDR2,5
                                           #define    	DDR26      	DDR2,6
                                           #define    	DDR27      	DDR2,7
                                           ;******************************
                                           
                                           
                                           ;#define       	inca   	       	addai 1
                                           
                                                  	       	;#include      	"def_men.asm"
                                           #define	       	Buffer0	   	0x00
                                           #define         Buffer1	   	0x01
                                           #define         Buffer2	   	0x02
                                           #define         Buffer3	   	0x03
                                           #define         Buffer4	   	0x04
                                           #define         Buffer5	   	0x05
                                           #define         Buffer6	   	0x06
                                           
                                           #define         TempRam1   	0x07
                                           #define         TempRam2   	0x08
                                           #define         TempRam3   	0x09
                                           #define         TempRam4   	0x0a
                                           #define         TempRam5   	0x0b
                                           #define         TempRam6   	0x0c
                                           
                                           #define         TempRam11  	0x0d
                                           #define         TempRam12  	0x0e
                                           #define         TempRam13  	0x0f
                                           
                                           #define         FtobH  	   	TempRam8
                                           #define         FtobL  	   	TempRam9
                                           ;************************************************
                                           ;************************************************
                                           ;Display Ram area
                                           ;************************************************
                                           #define	       	Display1       	0x10
                                           
                                           #define	       	Display2       	0x11
                                           #define	       	Dsp_Col	       	7
                                           
                                           #define	       	Display3       	0x12
                                           #define	       	Dsp_Point      	7
                                           
                                           #define	       	Display4       	0x13
                                           
                                           #define	       	DisplayFs1     	0x14
                                           
                                           ;************************************************
                                           ;************************************************
                                           #define	       	SysFlag1       	0x015
                                           WdtProcADFlag  	EQU    	       	0
                                           AdcStartFlag   	EQU    	       	1
                                           AdcOkFlag      	EQU    	       	2
                                           DataOkFlag     	EQU    	       	3
                                           SteadyFlag     	EQU    	       	4
                                           ZeroFlag       	EQU    	       	5
                                           NegFlag	       	EQU    	       	6
                                           
                                           #define	       	AdcStartFlag   	1
                                           #define	       	AdcOkFlag      	2
                                           #define	       	SteadyFlag     	3
                                           
                                           ;************************************************
                                           #define         H_DR   	   	0x16
                                           #define         M_DR   	   	0x17
                                           #define         L_DR   	   	0x18
                                           
                                           #define         H_DRBuf	   	0x19
                                           #define         M_DRBuf	   	0x1a
                                           #define         L_DRBuf	   	0x1b
                                           
                                           #define         H_DATA 	   	0x1c
                                           #define         M_DATA 	   	0x1d
                                           #define         L_DATA 	   	0x1e
                                           
                                           #define         H_DATAA	   	0x1f
                                           #define         M_DATAA	   	0x20
                                           #define         L_DATAA	   	0x21
                                           
                                           #define         H_DATAB	   	0x22
                                           #define         M_DATAB	   	0x23
                                           #define         L_DATAB	   	0x24
                                           
                                           #define         H_DATAC	   	0x25
                                           #define         M_DATAC	   	0x26
                                           #define         L_DATAC	   	0x27
                                           
                                           ;................................................
                                           #define         ADRamH 	   	0x28
                                           #define         ADRamM 	   	0x29
                                           #define         ADRamL 	   	0x2a
                                           
                                           #define         AD_Temp0   	0x2b
                                           #define         AD_Temp1   	0x2c
                                           #define         AD_Temp2   	0x2d
                                           #define         AD_Temp3   	0x2e
                                           
                                           ;************************************************
                                           ;Counter Area
                                           ;************************************************
                                           #define         delay_reg  	0x34
                                           #define         Reg0   	   	0x35
                                           #define         Reg1   	   	0x36
                                           #define         Reg2   	   	0x37
                                           #define         Reg3   	   	0x38
                                           ;************************************************
                                           ; Int  Buffer  RAM
                                           ;************************************************
                                           #define         DspZou8Count   	0x39
                                           
                                           #define         WorkRegBank	0x3a
                                           #define         StatusBank 	0x3b
                                           #define         SampleTimes	0x3c
                                           
                                           #define         TBASE01S   	0x3d
                                           #define         TBASE05S   	0x3e
                                           
                                           #define         DspData	   	0x3f
                                           #define         DspData1   	0x40
                                           #define         Tbase1S	   	0x41
                                           #define         AdcCount   	0x42
                                           
                                           #define         StableCount	0x46
                                           #define         Count1 	   	0x47
                                           
                                           #define         CalCount1H 	0x48
                                           #define         CalCount1L 	0x49
                                           #define         CalDot1L   	0x4A
                                           #define         CalDot1H   	0x4B
                                           #define         CalDot2L   	0x4C
                                           #define         CalDot2H   	0x4D
                                           #define         CalDot3L   	0x4E
                                           #define         CalDot3H   	0x4F
                                           
                                           #define         CalConstL  	0x50
                                           #define         CalConstH  	0x51
                                           #define         CountH 	   	0x52
                                           CountL 	   	EQU	   	53H
                                           TF1	   	EQU	   	54H
                                           Key_Up 	   	EQU	   	55H
                                           UnitKey	   	EQU        	0
                                           
                                           SysFlag3       	EQU    	       	56H
                                           DspNegFlag     	EQU    	       	0
                                           DspCalFlag     	EQU    	       	1
                                           GlintOpen1Flag 	EQU    	       	2
                                           UnLockDelayFlag	EQU    	       	3
                                           Glint1Flag     	EQU    	       	5
                                           ZFlashUnitFlag 	EQU    	       	7
                                           
                                           Timer1S	   	EQU	   	57H
                                           BiePoint   	EQU	   	58H
                                              	   	   	   	   	   	; 超载标志
                                           Power_Flags	EQU	   	5AH
                                           Reset_Flag 	EQU	   	0
                                           EeFull_Flag	EQU	   	1  	   	; 内部EEPROM已经标定满的标志
                                           FirTestBie_Flag	EQU	   	2  	   	; 首次测试BIE的标志
                                           ReadBie_Flag   	EQU	   	4
                                           CalNo6v_Flag   	EQU	   	6  	   	; 没有6V标定的标志
                                           FlashZFlag 	EQU	   	7
                                           
                                           AmendZeroL 	EQU	   	5BH
                                           AmendZeroH 	EQU	   	5CH
                                           
                                           T_Auto_Off 	EQU	   	5EH
                                           Prog_Flow  	EQU	   	5FH
                                           LockCountH 	EQU	   	60H
                                           LockCountL 	EQU	   	61H
                                           
                                           SysFlag2   	EQU	   	62H
                                           TF_01A 	   	EQU	   	0
                                           TF_01B 	   	EQU	   	1
                                           TF_05A 	   	EQU	   	2
                                           TF_05B 	   	EQU	   	3
                                           GlintOpenFlag   EQU	   	4  	   	; 允许进入中断处理闪烁的标志
                                           GlintFlag  	EQU	   	5  	   	; 闪烁亮
                                           GlintFlagCom    EQU	   	00100000B
                                           Dsp_Hide   	EQU	   	6
                                           DspHideData	EQU	   	01000000b
                                           
                                           WTMemCount 	EQU	   	63H
                                           LCount 	   	EQU	   	64H
                                           LLCount	   	EQU	   	65H
                                           
                                           SysFlag4   	EQU	   	66H
                                           StopFlag   	EQU        	0
                                           StartFlag       EQU        	1
                                           LockFlag        EQU        	2
                                           ErrEFlag        EQU        	3
                                           LowBatFlag      EQU        	4
                                           
                                           TrackCount 	EQU	   	67H
                                           MaxCountH  	EQU	   	68H
                                           MaxCountL  	EQU	   	69H
                                           
                                           Status_Flags   	EQU	   	6CH
                                           SWUnitFlag 	EQU	   	0  	   	; 拨动开关单位转换标志
                                           ZhenDong_Flag   EQU	   	1  	   	; 振动开机方式
                                           Flash5_Flag	EQU	   	2  	   	; 锁定后闪烁5次关机
                                           TwoUnit_Flag    EQU        	3  	   	; 2个单位的标志
                                           Max162KG_Flag   EQU        	4  	   	; 满载为162KG
                                           Max182KG_Flag   EQU        	5  	   	; 满载为182KG
                                           Max202KG_Flag   EQU        	6  	   	; 满载为202KG
                                           
                                           FlashZTimeL	EQU	   	6DH
                                           FlashZTimeH	EQU	   	6EH
                                           
                                           SysFlag5   	EQU	   	6FH
                                           FlashZeroFlag  	EQU	   	3  	   	; 已经刷新零点的标志
                                           FirTracZeroFlag	EQU	   	4  	   	; 首次归零标志
                                           WdtTrackSFlag  	EQU	   	6
                                           WdtTrackBFlag  	EQU	   	7
                                           
                                           WakenUpCount   	EQU	   	70H
                                           AmendZeroM 	EQU	   	71H
                                           TempRam8   	EQU	   	72H
                                           TempRam9   	EQU	   	73H
                                           DisplayFlag	EQU	   	74H
                                           Dsp_Kg          EQU	   	0
                                           Dsp_Lb          EQU	   	1
                                           Dsp_St          EQU        	2
                                           
                                           NoSteadyCount  	EQU	   	75H
                                           KeyTimes   	EQU	   	76H
                                           ScanKeyCount   	EQU	   	77H
                                           Key1   	   	EQU	   	78H
                                           Key2   	   	EQU	   	79H
                                           KeyTmr 	   	EQU	   	7AH
                                           
                                           displaycal1	EQU	   	7BH
                                           displaycal2	EQU	   	7CH
                                           displaycal3	EQU	   	7DH
                                           
                                           tempcal1   	EQU	   	7EH	   	; 读内部BIE寄存器
                                           tempcal2   	EQU	   	7FH
                                           tempcal3   	EQU	   	80H
                                           tempcal4   	EQU	   	81H
                                           
                                           keycode	   	EQU	   	82H
                                           SysFlag6   	EQU	   	83H
                                           Caldis 	   	EQU	   	0
                                           TestWdt	   	EQU	   	1
                                           weight_have	EQU	   	2  	   	; 有重量不进STOP
                                           second 	   	EQU	   	84H
                                           
                                           DisplayRam1     EQU	   	86H
                                           DisplayRam2     EQU	   	87H
                                           DisplayRam3     EQU	   	88H
                                           DisplayRam4     EQU	   	89H
                                           delay_reg1      EQU	   	8AH
                                           Key_Times       EQU	   	8BH
                                           second2         EQU	   	8CH
                                           second3         EQU	   	8DH
                                           
                                           CheckRam1       EQU	   	8EH
                                           CheckRam2       EQU	   	8FH
                                           CheckRam3       EQU	   	90H
                                           CheckRam4       EQU	   	91H
                                           CheckRam5       EQU	   	92H
                                           CheckRam6       EQU	   	93H
                                           Lo_Counter      EQU	   	94H
                                           REG3   	   	EQU	   	95H
                                           FlashK 	   	EQU	   	96H
                                           Fk_ADFI	   	EQU	   	0
                                           
                                           ;关机不清零
                                           AutoOn_Flags   	EQU    	       	0CCH
                                           WakenOn_Flag   	EQU    	       	0
                                           WdtWaken_Flag  	EQU    	       	1
                                           DispOk_Flag    	EQU    	       	2
                                           KeyOn_Flag     	EQU    	       	3
                                           UnStableFlag   	EQU    	       	5      	       	; 不稳定关机标志
                                           OnWeightFlag   	EQU    	       	6      	       	; 有重量在秤台上的标志
                                           OverLoadFlag   	EQU    	       	7
                                           UnitFlag       	EQU    	       	0CDH
                                           KgFlag 	       	EQU    	       	0
                                           LbFlag 	       	EQU    	       	1
                                           StFlag 	       	EQU    	       	2
                                           
                                           #define	       	ZeroH  	       	0xCE
                                           #define	       	ZeroM  	       	0xCF
                                           #define	       	ZeroL  	       	0xD0
                                           
                                           AutoOnADH  	EQU	   	0XD1   	   	;6AH
                                           AutoOnADL  	EQU	   	0XD2   	   	;6BH
                                           
                                           ;************************************************
                                           ;立即数
                                           ;************************************************
                                           
                                                  	       	;#include      	"macro.asm"
                                           ;===========================================
                                           ; 宏定义
                                           ;===========================================
                                           ;..................................
                                           ; Move Number to File Register
                                           ;..................................
                                           movfl  	       	macro  	       	f1,d1
000038   3c10     movai   0x10                    	       	movai  	       	d1
000039   565e     movra   0x5e                	   	movra  	       	f1
                                                  	       	endm
                                           
                                           ;..................................
                                           ; Move File to File Register
                                           ;..................................
                                           movff  	       	macro  	       	f2,f1
0000e0   5816     movar   0x16                    	       	movar  	       	f1
0000e1   56ce     movra   0xce                    	       	movra  	       	f2
                                                  	       	endm
                                           
                                           ;*******************************************************
                                           ;*******************************************************
                                                  	       	org    	       	00H
                                           ;************************************************
000000   0000     nop                             	       	nop
000001   eb88     jbset   0x188, 0x5              	       	jbset  	       	MCR,5
000002   a55c     goto    0x55c                   	       	goto   	       	SysInit
000003   a514     goto    0x514                   	       	goto   	       	WDTWankenUp    	       	;TO=1:发生WDT溢出
                                           
                                           ;************************************************
                                                  	       	org    	       	08H
                                                  	       	;#include      	"int.asm"
                                           ;************************************************
                                           IntrruptProc:
000008   563a     movra   0x3a                    	       	movra  	       	WorkRegBank
000009   5987     movar   0x187                   	       	movar  	       	STATUS
00000a   563b     movra   0x3b                    	       	movra  	       	StatusBank
                                           
                                           ;................................................
                                           Proc1_Interrupt:
00000b   e58a     jbset   0x18a, 0x2              	       	jbset  	       	INTE, 2
00000c   a010     goto    0x10                    	       	goto   	       	IntrruptProc1
                                           
00000d   e58b     jbset   0x18b, 0x2              	       	jbset  	       	INTF, 2
00000e   a010     goto    0x10                    	       	goto   	       	IntrruptProc1
00000f   a01a     goto    0x1a                    	       	goto   	       	Ext0Int
                                           IntrruptProc1:
000010   ed8a     jbset   0x18a, 0x6              	       	jbset  	       	INTE, 6
000011   a014     goto    0x14                             goto   	       	ExitIntProc
                                           
000012   fd8b     jbclr   0x18b, 0x6              	       	jbclr  	       	INTF, 6
000013   a01e     goto    0x1e                    	       	goto   	       	ADCInt
                                           
                                           ;************************************************
                                           ExitIntProc:
000014   3c00     movai   0                       	       	movai  	       	0x00
000015   578b     movra   0x18b                   	       	movra  	       	INTF
000016   583b     movar   0x3b                    	       	movar  	       	StatusBank
000017   5787     movra   0x187                   	       	movra  	       	STATUS
000018   583a     movar   0x3a                    	       	movar  	       	WorkRegBank
000019   000d     retie                           	       	retie
                                           
                                           ;************************************************
                                           ;外部中断
                                           ;************************************************
                                           Ext0Int:
00001a   d58b     bclr    0x18b, 0x2              	       	bclr   	       	INTF, 2
00001b   3cfe     movai   0xfe                    	       	movai  	       	0xfe
00001c   578b     movra   0x18b                   	       	movra  	       	INTF
00001d   a014     goto    0x14                    	       	goto   	       	ExitIntProc
                                           
                                           ;************************************************
                                           ;ADC中断
                                           ;************************************************
                                           ADCInt:
00001e   6657     incr    0x57                    	       	incr   	       	Timer1S
00001f   c096     bset    0x96, 0                 	       	bset   	       	FlashK,Fk_ADFI
000020   000e     clrwdt                          	       	CLRWDT
                                           
000021   e466     jbset   0x66, 0x2               	       	jbset  	       	SysFlag4,LockFlag      	;锁定的标志位
000022   a03d     goto    0x3d                    	       	goto   	       	TimerInt2End
                                           
000023   e862     jbset   0x62, 0x4               	       	jbset  	       	SysFlag2,GlintOpenFlag
000024   a03d     goto    0x3d                    	       	goto   	       	TimerInt2End
                                           ;-------------------------------
000025   6664     incr    0x64                             incr          LCount
000026   3c11     movai   0x11                             movai         17
000027   4864     rsubar  0x64                             RSUBAR         LCount
000028   e187     jbset   0x187, 0                         jbset          C
000029   a03d     goto    0x3d                             goto          TimerInt2End
                                           
00002a   7664     clrr    0x64                             clrr          LCount
00002b   6665     incr    0x65                             incr          LLCount
                                           
00002c   3c20     movai   0x20                             movai         GlintFlagCom
00002d   4262     xorra   0x62                             XORRA         SysFlag2                   ; 闪烁取反
                                           
00002e   3c04     movai   0x4                              movai         4                              ; 闪烁2次
00002f   f46c     jbclr   0x6c, 0x2                        jbclr         Status_Flags,Flash5_Flag
000030   3c0a     movai   0xa                              movai         10                              ; 闪烁5次关机
                                           
000031   4865     rsubar  0x65                             RSUBAR         LLCount
000032   e187     jbset   0x187, 0                         jbset          C
000033   a03d     goto    0x3d                             goto          TimerInt2End
                                           
000034   7665     clrr    0x65                             clrr          LLCount
000035   d862     bclr    0x62, 0x4                        bclr          SysFlag2,GlintOpenFlag
000036   f46c     jbclr   0x6c, 0x2                        jbclr         Status_Flags,Flash5_Flag
000037   a03b     goto    0x3b                             goto          TimerInt1A
                                                           movfl         T_Auto_Off, 16      ;movff          T_Auto_Off,T_WeightMode
00003a   a03d     goto    0x3d                             goto          TimerInt2End
                                           TimerInt1A:
00003b   3c03     movai   0x3                              movai                3
00003c   4a5e     rsubra  0x5e                             RSUBRA         T_Auto_Off
                                           TimerInt2End:
                                           ;-------------------------------
                                           TimerInt3:
00003d   6684     incr    0x84                    	       	incr   	       	second
00003e   668d     incr    0x8d                    	       	incr   	       	second3
00003f   668c     incr    0x8c                    	       	INCR   	       	second2
000040   663e     incr    0x3e                    	       	incr   	       	TBASE05S
000041   3c05     movai   0x5                     	       	movai  	       	5
000042   483e     rsubar  0x3e                    	       	RSUBAR 	       	TBASE05S
000043   e187     jbset   0x187, 0                	       	jbset  	       	C
000044   a047     goto    0x47                    	       	goto   	       	TimerInt4      	       	;C=0,TBASE05S<5
                                           
000045   763e     clrr    0x3e                    	       	clrr   	       	TBASE05S       	       	;C=1,TBASE05S>=5
000046   c462     bset    0x62, 0x2               	       	bset   	       	SysFlag2,TF_05A
                                           ;-------------------------------
                                           TimerInt4:
000047   6a7a     djzr    0x7a                    	       	DJZR   	       	KeyTmr 	       	       	;KeyTmr-1
000048   a04b     goto    0x4b                    	       	goto   	       	ADCInt_Time    	       	;KeyTmr>0
                                           
000049   7676     clrr    0x76                    	       	clrr   	       	KeyTimes       	       	;KeyTmr=0
00004a   767a     clrr    0x7a                    	       	clrr   	       	KeyTmr
                                           ;*******************************
                                           ADCInt_Time:
00004b   dd8b     bclr    0x18b, 0x6              	       	bclr   	       	INTF, 6	       	       	;ADIF=0
00004c   663c     incr    0x3c                    	       	incr   	       	SampleTimes
                                           
00004d   e215     jbset   0x15, 0x1               	       	jbset  	       	SysFlag1,AdcStartFlag
00004e   a05a     goto    0x5a                    	       	goto   	       	ADCInt1
                                           
00004f   3c04     movai   0x4                     	       	movai  	       	4
000050   483c     rsubar  0x3c                    	       	rsubar 	       	SampleTimes
000051   e187     jbset   0x187, 0                	       	jbset  	       	C
000052   a014     goto    0x14                    	       	goto   	       	ExitIntProc    	       	;SampleTimes<4
                                           
000053   d215     bclr    0x15, 0x1               	       	bclr   	       	SysFlag1,AdcStartFlag  	;SampleTimes>=4
000054   763c     clrr    0x3c                    	       	clrr   	       	SampleTimes
000055   762b     clrr    0x2b                    	       	clrr   	       	AD_Temp0
000056   762c     clrr    0x2c                    	       	clrr   	       	AD_Temp1
000057   762d     clrr    0x2d                    	       	clrr   	       	AD_Temp2
000058   762e     clrr    0x2e                    	       	clrr   	       	AD_Temp3
000059   a014     goto    0x14                    	       	goto   	       	ExitIntProc
                                           ;................................................
                                           ADCInt1:
00005a   59b4     movar   0x1b4                   	       	movar  	       	ADRH
00005b   5628     movra   0x28                    	       	movra  	       	ADRamH
00005c   59b5     movar   0x1b5                   	       	movar  	       	ADRM
00005d   5629     movra   0x29                    	       	movra  	       	ADRamM
00005e   59b6     movar   0x1b6                   	       	movar  	       	ADRL
00005f   562a     movra   0x2a                    	       	movra  	       	ADRamL 	       	       	;保存24位ADC结果至ADRam(24bit)
                                           
000060   3c00     movai   0                       	       	movai  	       	0x00
000061   7e2a     addra   0x2a                    	       	addra  	       	ADRamL
000062   3c00     movai   0                       	       	movai  	       	0x00
000063   1229     adcra   0x29                    	       	adcra  	       	ADRamM
000064   3c80     movai   0x80                    	       	movai  	       	0x80
000065   1228     adcra   0x28                    	       	adcra  	       	ADRamH 	       	       	;ADRam + 0x800000 ?
000066   f2cc     jbclr   0xcc, 0x1               	       	jbclr  	       	AutoOn_Flags,WdtWaken_Flag
000067   a088     goto    0x88                    	       	goto   	       	AdcInt3
                                           ;................................................
                                           ADCInt2:   	   	   	   	   	   	;复位初始采样
000068   582a     movar   0x2a                    	       	movar  	       	ADRamL
000069   7e2e     addra   0x2e                    	       	addra  	       	AD_Temp3
00006a   5829     movar   0x29                    	       	movar  	       	ADRamM
00006b   122d     adcra   0x2d                    	       	adcra  	       	AD_Temp2
00006c   5828     movar   0x28                    	       	movar  	       	ADRamH
00006d   122c     adcra   0x2c                    	       	adcra  	       	AD_Temp1
00006e   3c00     movai   0                       	       	movai  	       	0
00006f   122b     adcra   0x2b                    	       	adcra  	       	AD_Temp0       	       	;AD_Temp(32b) + ADRam(24b) -> AD_Temp
                                           
000070   3c08     movai   0x8                     	       	movai  	       	8
000071   483c     rsubar  0x3c                    	       	rsubar 	       	SampleTimes
000072   e187     jbset   0x187, 0                	       	jbset  	       	C
000073   a014     goto    0x14                    	       	goto   	       	ExitIntProc
                                           ;---------------
000074   763c     clrr    0x3c                    	       	clrr   	       	SampleTimes    	       	;采样8次
000075   3c0a     movai   0xa                     	       	movai  	       	10     	       	; 取19bit的内码数据
000076   5642     movra   0x42                    	       	movra  	       	AdcCount
000077   d187     bclr    0x187, 0         ADCInt2Loop:   	bclr   	       	C
000078   4e2b     rrr     0x2b                    	       	rrr    	       	AD_Temp0
000079   4e2c     rrr     0x2c                    	       	rrr    	       	AD_Temp1
00007a   4e2d     rrr     0x2d                    	       	rrr    	       	AD_Temp2
00007b   4e2e     rrr     0x2e                    	       	rrr    	       	AD_Temp3
00007c   6a42     djzr    0x42                    	       	djzr   	       	AdcCount
00007d   a077     goto    0x77                    	       	goto   	       	ADCInt2Loop
                                           
00007e   582c     movar   0x2c                    	       	movar  	       	AD_Temp1
00007f   561c     movra   0x1c                    	       	movra  	       	H_DATA
000080   582d     movar   0x2d                    	       	movar  	       	AD_Temp2
000081   561d     movra   0x1d                    	       	movra  	       	M_DATA
000082   582e     movar   0x2e                    	       	movar  	       	AD_Temp3
000083   561e     movra   0x1e                    	       	movra  	       	L_DATA 	       	       	;24位ADC数据*8/1024=17位数据,结果存于HML_DATA
                                           
000084   762b     clrr    0x2b                    	       	clrr   	       	AD_Temp0
000085   762c     clrr    0x2c                    	       	clrr   	       	AD_Temp1
000086   762d     clrr    0x2d                    	       	clrr   	       	AD_Temp2
000087   762e     clrr    0x2e                    	       	clrr   	       	AD_Temp3
                                           ;................................................
                                           AdcInt3:
000088   c415     bset    0x15, 0x2                        bset            SysFlag1,AdcOkFlag
000089   a014     goto    0x14                             goto            ExitIntProc
                                           
                                           ;;*************************************************
                                           ;
                                           
                                           ;**************************************************
                                           
                                                           ;#include         "subroutine.asm"
                                           ;***********************************************
                                           delay1:	   	   	   	   	   	   	;延时约198K指令周期
00008a   3cff     movai   0xff                	   	movai  	   	0xff
00008b   5634     movra   0x34                        	movra  	   	delay_reg
00008c   3cff     movai   0xff                        	movai  	   	0xff
00008d   0010     djza                                	djza
00008e   a08d     goto    0x8d                        	goto   	   	$-1
00008f   0000     nop                                 	nop
000090   0000     nop                                 	nop
000091   0000     nop                                 	nop
000092   000e     clrwdt                              	clrwdt
000093   0000     nop                                 	nop
000094   0000     nop                                 	nop
000095   0000     nop                                 	nop
000096   0000     nop                                 	nop
000097   6a34     djzr    0x34                        	djzr   	   	delay_reg
000098   a08c     goto    0x8c                        	goto   	   	$-12
000099   000c     return                              	return
                                           ;-------------------------------
                                           delay2:	   	   	   	   	   	   	;延时约791K指令周期
00009a   3cff     movai   0xff                	   	movai      	0xff
00009b   568a     movra   0x8a                    	   	movra      	delay_reg1
00009c   3cff     movai   0xff                        	movai      	0xff
00009d   5634     movra   0x34                        	movra      	delay_reg
00009e   3cff     movai   0xff                        	movai      	0xff
00009f   0010     djza                                	djza
0000a0   a09f     goto    0x9f                        	goto       	$-1
0000a1   0000     nop                                 	nop	   	   	   	   	;延时255*3=765指令周期
0000a2   0000     nop                                 	nop
0000a3   0000     nop                                 	nop
0000a4   0000     nop                                 	nop
0000a5   0000     nop                             	   	nop
0000a6   0000     nop                                 	nop
0000a7   0000     nop                                 	nop
0000a8   0000     nop                                 	nop
                                           delay2A:
0000a9   3cff     movai   0xff                        	movai      	0xff
0000aa   5634     movra   0x34                    	   	movra      	delay_reg
0000ab   0010     djza                            	       	djza
0000ac   a0ab     goto    0xab                        	goto   	   	$-1
0000ad   0000     nop                                 	nop
0000ae   0000     nop                                 	nop
0000af   0000     nop                                 	nop
0000b0   0000     nop                                 	nop
0000b1   0000     nop                             	       	nop
0000b2   0000     nop                                 	nop
0000b3   0000     nop                                 	nop
0000b4   0000     nop                                 	nop
0000b5   3cff     movai   0xff                    	       	movai      	0xff
0000b6   5634     movra   0x34                    	   	movra      	delay_reg
0000b7   0010     djza                            	       	djza
0000b8   a0b7     goto    0xb7                        	goto       	$-1
0000b9   0000     nop                                 	nop
0000ba   0000     nop                                 	nop
0000bb   0000     nop                                 	nop
0000bc   0000     nop                                 	nop
0000bd   0000     nop                             	       	nop
0000be   0000     nop                                 	nop
0000bf   0000     nop                                 	nop
0000c0   0000     nop                                 	nop
0000c1   3cff     movai   0xff                    	       	movai      	0xff
0000c2   5634     movra   0x34                    	   	movra      	delay_reg
0000c3   0010     djza                            	       	djza
0000c4   a0c3     goto    0xc3                        	goto       	$-1
0000c5   0000     nop                                 	nop
0000c6   0000     nop                                 	nop
0000c7   0000     nop                                 	nop
0000c8   0000     nop                                 	nop
0000c9   0000     nop                             	       	nop
0000ca   0000     nop                                 	nop
0000cb   0000     nop                                 	nop
0000cc   0000     nop                                 	nop
0000cd   3cff     movai   0xff                    	       	movai      	0xff
0000ce   5634     movra   0x34                    	   	movra      	delay_reg
0000cf   0010     djza                            	       	djza
0000d0   a0cf     goto    0xcf                        	goto       	$-1
0000d1   0000     nop                                 	nop
0000d2   0000     nop                                 	nop
0000d3   0000     nop                                 	nop
0000d4   0000     nop                                 	nop
0000d5   0000     nop                             	       	nop
0000d6   0000     nop                                 	nop
0000d7   0000     nop                                 	nop
0000d8   0000     nop                                 	nop
                                           
0000d9   6a8a     djzr    0x8a                    	       	DJZR       	delay_reg1
0000da   a0a9     goto    0xa9                        	goto       	delay2A
0000db   000c     return                              	return
                                           
                                           ;*************************************************
                                           ;晶振启动时丢弃不稳定的AD
                                           ;*************************************************
                                           discard_ad:
0000dc   c215     bset    0x15, 0x1                bset            SysFlag1,AdcStartFlag
0000dd   763c     clrr    0x3c                     clrr            SampleTimes
0000de   d415     bclr    0x15, 0x2                bclr            SysFlag1,AdcOkFlag
0000df   000c     return                           return
                                           
                                           
                                           ;**************************************************
                                           ;取零点内码
                                           ;**************************************************
                                           GetZeroPoint:
                                                           movff           ZeroH,H_DR
                                                           movff           ZeroM,M_DR
                                                           movff           ZeroL,L_DR
0000e6   000c     return                                   return
                                           
                                           ;**************************************************
                                           ;当前内码与零点内码之差的子程序
                                           ;**************************************************
                                           CurAD_ZeroAD:
                                                           movff           TempRam1,H_DR
                                                           movff           TempRam2,M_DR
                                                           movff           TempRam3,L_DR
                                                           movff           TempRam4,ZeroH
                                                           movff           TempRam5,ZeroM
                                                           movff           TempRam6,ZeroL
0000f3   8197     call    0x197                            call            _Sub3_3
0000f4   000c     return                                   return
                                           ;**************************************************
                                           ;转换校磅流程
                                           ;**************************************************
                                           Change_F1:
0000f5   d187     bclr    0x187, 0                         bclr           PFALG, 0
0000f6   5254     rlr     0x54                             rlr             TF1
0000f7   d615     bclr    0x15, 0x3                        bclr            SysFlag1,SteadyFlag
0000f8   7646     clrr    0x46                             clrr            StableCount
0000f9   000c     return                           return
                                           
                                           ;**************************************************
                                           ;funtion: 实际要显示的分度(没有任何放大）
                                           ;input  : TempRam5 TempRam6
                                           ;output : TempRam5 TempRam6
                                           ;**************************************************
                                           GetRealCount:
0000fa   3c02     movai   0x2                              movai           2
0000fb   4a0c     rsubra  0xc                              RSUBRA          TempRam6
0000fc   3c00     movai   0                                movai           0
0000fd   120b     adcra   0xb                              ADCRA           TempRam5
                                           
0000fe   d187     bclr    0x187, 0                     bclr            PFALG, 0
0000ff   4e0b     rrr     0xb                              rrr             TempRam5
000100   4e0c     rrr     0xc                              rrr             TempRam6
                                           
000101   d187     bclr    0x187, 0                     bclr            PFALG, 0
000102   4e0b     rrr     0xb                              rrr             TempRam5
000103   4e0c     rrr     0xc                              rrr             TempRam6                           ;除以4
000104   000c     return                           return
                                           
                                           ;**************************************************
                                           ;实际数据与锁定数据的差值
                                           ;output : TempRam3 TempRam4
                                           ;**************************************************
                                           Real_LockCount:
                                                           movff           TempRam3,CountH
                                                           movff           TempRam4,CountL
                                                           movff           TempRam5,LockCountH
                                                           movff           TempRam6,LockCountL
00010d   8189     call    0x189                            CALL            _Sub2_2
                                                           ;CALL            _Neg2
00010e   000c     return                                   return
                                           
                                           _GetAutoOnDC:
00010f   760a     clrr    0xa                              clrr            TempRam4
                                                           movff           TempRam5,CalDot1H
                                                           movff           TempRam6,CalDot1L
                                           
000114   760e     clrr    0xe                              clrr            TempRam12
                                                           movfl           TempRam13, 40                           ;movff          TempRam13,AutoOnCount
000117   81dc     call    0x1dc                            call            _Mul3_2
000118   760d     clrr    0xd                              clrr            TempRam11
                                                           movff           TempRam12,CalCount1H
                                                           movff           TempRam13,CalCount1L            ;CalDot1H*40/CalCount1H（商456 余数123）
00011d   81aa     call    0x1aa                            call            _Div6_3
00011e   81c9     call    0x1c9                            call            _ProcAdd1
                                           
                                                           movfl           TempRam1, 3
                                           _GetAutoOnDCLoop:
000121   d187     bclr    0x187, 0                         bclr            PFALG, 0
000122   4e0a     rrr     0xa                              rrr             TempRam4
000123   4e0b     rrr     0xb                              rrr             TempRam5
000124   4e0c     rrr     0xc                              rrr             TempRam6                            ;商除以2
                                           
000125   6a07     djzr    0x7                              DJZR            TempRam1
000126   a121     goto    0x121                            goto            _GetAutoOnDCLoop
                                           
                                                           movff           TempRam2,ZeroH
                                                           movff           TempRam3,ZeroM
                                                           movff           TempRam4,ZeroL
                                           
                                                           movfl           TempRam1, 1
                                           _GetAutoOnDCLoop1:
00012f   d187     bclr    0x187, 0                         bclr            PFALG, 0
000130   4e08     rrr     0x8                              rrr             TempRam2
000131   4e09     rrr     0x9                              rrr             TempRam3
000132   4e0a     rrr     0xa                              rrr             TempRam4
                                           
000133   6a07     djzr    0x7                              DJZR            TempRam1
000134   a12f     goto    0x12f                            goto            _GetAutoOnDCLoop1
                                           
000135   8184     call    0x184                            call            _Add2_2                 ; 因为看门狗唤醒时取的内码是正常工作时内码的1/8，因此，这里的内码也要除以8
                                           
                                                           movff           AutoOnADH,TempRam3
                                                           movff           AutoOnADL,TempRam4
                                                  	       	       	       	;incr            AutoOnADH
                                                  	       	       	       	;incr            AutoOnADH
                                           
00013a   000c     return                          return
                                           
                                           option:
00013b   3c04     movai   0x4                          movai       0x04
00013c   57ae     movra   0x1ae                    movra   OSCM
00013d   ebae     jbset   0x1ae, 0x5              jbset    OSCM,5
00013e   a13d     goto    0x13d                    goto    $-1
00013f   3cfc     movai   0xfc                     movai     0xfc
000140   56f7     movra   0xf7                         movra         0x0F7
                                           
000141   3c00     movai   0                       movai    0x00
000142   57ae     movra   0x1ae                   movra    OSCM
000143   e9ae     jbset   0x1ae, 0x4              jbset   OSCM,4
000144   a143     goto    0x143                   goto    $-1
000145   0000     nop                             nop
000146   000c     return                              return
                                           
                                           CLRR_LCD:
000147   77c2     clrr    0x1c2                  CLRR    LCDDS0
000148   77c3     clrr    0x1c3                   	  CLRR    LCDDS1
000149   3c00     movai   0                       	       	  movai   0x00
00014a   57c2     movra   0x1c2                   	       	  movra   LCDDS0
00014b   57c3     movra   0x1c3                   	       	  movra   LCDDS1
00014c   77c4     clrr    0x1c4                   	  CLRR    LCDDS2
00014d   77c5     clrr    0x1c5                   	  CLRR    LCDDS3
00014e   77c6     clrr    0x1c6                   	  CLRR    LCDDS4
00014f   77c7     clrr    0x1c7                   	  CLRR    LCDDS5
000150   77c8     clrr    0x1c8                   	  CLRR    LCDDS6
000151   77c9     clrr    0x1c9                   	  CLRR    LCDDS7
000152   77ca     clrr    0x1ca                   	  CLRR    LCDDS8
000153   77cb     clrr    0x1cb                   	  CLRR    LCDDS9
000154   77cc     clrr    0x1cc                   	  CLRR    LCDDS10
                                           
000155   000c     return                          	  RETURN
                                           
                                           Disp_To_Ram:
                                                    movff   Display1,DisplayRam1
                                                  	       	 movff   Display2,DisplayRam2
                                                  	       	 movff   Display3,DisplayRam3
                                                  	       	 movff   Display4,DisplayRam4
00015e   000c     return                          	       	 RETURN
                                           Ram_To_Disp:
                                                  	       	movff  	       	DisplayRam1,Display1
                                                  	       	 movff   DisplayRam2,Display2
                                                  	       	 movff   DisplayRam3,Display3
                                                  	       	 movff   DisplayRam4,Display4
000167   000c     return                          	       	 RETURN
                                           
                                           delay3:
                                           
000168   3cff     movai   0xff                     movai   0xff
000169   5634     movra   0x34                     movra   delay_reg
00016a   3cff     movai   0xff                     movai   0xff
00016b   0010     djza                             djza
00016c   a16b     goto    0x16b                    goto    $-1
00016d   0000     nop                              nop
00016e   0000     nop                              nop
00016f   0000     nop                              nop
000170   0000     nop                              nop
000171   0000     nop                              nop
000172   0000     nop                              nop
000173   0000     nop                              nop
000174   0000     nop                              nop
000175   6a34     djzr    0x34                     djzr    delay_reg
000176   a16a     goto    0x16a                    goto    $-12
000177   000c     return                           return
                                           
                                           delay4:
000178   5634     movra   0x34                    	movra   delay_reg
000179   0000     nop                      dlylp4 	nop
00017a   0000     nop                             	nop
00017b   0000     nop                             	nop
00017c   0000     nop                             	nop
00017d   0000     nop                             	nop
00017e   0000     nop                             	nop
00017f   0000     nop                             	nop
000180   0000     nop                             	nop
000181   6a34     djzr    0x34                    	djzr    delay_reg
000182   a179     goto    0x179                   	goto    dlylp4
000183   000c     return                          	return
                                           
                                                          ;#include         "Computer.asm"
                                           ;************************************************
                                           ;Title  : Calculate Subroutine
                                           ;Author : Kevin Lee
                                           ;Date   : 2015/6/5 16:19
                                           ;**************************************************
                                           ;**************************************************
                                           ;input  :       TempRam3, TempRam4
                                           ;                   TempRam5, TempRam6
                                           ;output :
                                           ;                   TempRam3, TempRam4
                                           ;**************************************************
                                           _Add2_2:
000184   580c     movar   0xc                     	       	movar  	       	TempRam6
000185   7e0a     addra   0xa                     	       	ADDRA  	       	TempRam4
000186   580b     movar   0xb                     	       	movar  	       	TempRam5
000187   1209     adcra   0x9                     	       	ADCRA  	       	TempRam3
000188   000c     return                          	       	return
                                           
                                           ;**************************************************
                                           ;input  :       (TempRam3,TempRam4) - (TempRam5,TempRam6)
                                           ;output :       (TempRam3,TempRam4)
                                           ;**************************************************
                                           _Sub2_2:
000189   580c     movar   0xc                              movar           TempRam6
00018a   4a0a     rsubra  0xa                              rsubra          TempRam4
00018b   580b     movar   0xb                              movar           TempRam5
00018c   0e09     rsbcra  0x9                              rsbcra          TempRam3
00018d   f187     jbclr   0x187, 0                         jbclr          	C
00018e   000c     return                                   return
                                           
00018f   700a     comar   0xa                              comar           TempRam4
000190   3f01     addai   0x1                              addai           1
000191   560a     movra   0xa                              movra           TempRam4
000192   7009     comar   0x9                              comar           TempRam3
000193   7609     clrr    0x9                              clrr            TempRam3
000194   1209     adcra   0x9                              adcra           TempRam3
000195   d187     bclr    0x187, 0                         bclr            C
000196   000c     return                                   return
                                           
                                           ;**************************************************
                                           ;input  :       (TempRam1,TempRam2,TempRam3) - (TempRam4,TempRam5,TempRam6)
                                           ;output :       (TempRam1,TempRam2,TempRam3)
                                           ;**************************************************
                                           _Sub3_3:
000197   580c     movar   0xc                              movar           TempRam6
000198   4a09     rsubra  0x9                              rsubra          TempRam3
000199   580b     movar   0xb                              movar           TempRam5
00019a   0e08     rsbcra  0x8                              rsbcra          TempRam2
00019b   580a     movar   0xa                              movar           TempRam4
00019c   0e07     rsbcra  0x7                              rsbcra          TempRam1
00019d   f187     jbclr   0x187, 0                         jbclr           C
00019e   000c     return                                   return
                                           
00019f   7009     comar   0x9                              comar           TempRam3
0001a0   3f01     addai   0x1                              addai           1
0001a1   5609     movra   0x9                              movra           TempRam3
0001a2   7008     comar   0x8                              comar           TempRam2
0001a3   7608     clrr    0x8                              clrr            TempRam2
0001a4   1208     adcra   0x8                              adcra           TempRam2
0001a5   7007     comar   0x7                              comar           TempRam1
0001a6   7607     clrr    0x7                              clrr            TempRam1
0001a7   1207     adcra   0x7                              adcra           TempRam1
0001a8   d187     bclr    0x187, 0                         bclr            C
0001a9   000c     return                                   return
                                           
                                           
                                           ;**************************************************
                                           ;input  :       TempRam2, TempRam3  TempRam4, TempRam5, TempRam6
                                           ;               TempRam11,TempRam12,TempRam13
                                           ;output :
                                           ;yushu  :       TempRam1, TempRam2, TempRam3
                                           ;shang  :       TempRam4, TempRam5, TempRam6
                                           ;temp   :       buffer0,buffer1,buffer2,buffer3
                                           ;**************************************************
                                           _Div6_3:
0001aa   7607     clrr    0x7                              clrr            TempRam1
                                                           movfl           Buffer3, 24
                                           _Div6_3Loop:
0001ad   d187     bclr    0x187, 0                         bclr            PFALG, 0
0001ae   520c     rlr     0xc                              rlr             TempRam6
0001af   520b     rlr     0xb                              rlr             TempRam5
0001b0   520a     rlr     0xa                              rlr             TempRam4
0001b1   5209     rlr     0x9                              rlr             TempRam3
0001b2   5208     rlr     0x8                              rlr             TempRam2
0001b3   5207     rlr     0x7                              rlr             TempRam1
                                           
0001b4   580f     movar   0xf                              movar           TempRam13
0001b5   4809     rsubar  0x9                              rsubar          TempRam3
0001b6   5602     movra   0x2                              movra           Buffer2
                                           
0001b7   580e     movar   0xe                              movar           TempRam12
0001b8   0c08     rsbcar  0x8                              rsbcar          TempRam2
0001b9   5601     movra   0x1                              movra           Buffer1
                                           
0001ba   580d     movar   0xd                              movar           TempRam11
0001bb   0c07     rsbcar  0x7                              rsbcar          TempRam1
0001bc   5600     movra   0                                movra           Buffer0
                                           
0001bd   e187     jbset   0x187, 0                         jbset           PFALG, 0
0001be   a1c6     goto    0x1c6                            goto            _Div6_3Loop1
                                           
                                                           movff           TempRam1,Buffer0
                                                           movff           TempRam2,Buffer1
                                                           movff           TempRam3,Buffer2
                                           
0001c5   660c     incr    0xc                              incr            TempRam6
                                           _Div6_3Loop1:
0001c6   6a03     djzr    0x3                              djzr            Buffer3
0001c7   a1ad     goto    0x1ad                            goto            _Div6_3Loop
0001c8   000c     return                                   return
                                           
                                           ;**************************************************
                                           _ProcAdd1:
0001c9   d187     bclr    0x187, 0                         bclr            PFALG, 0
0001ca   5209     rlr     0x9                              rlr             TempRam3
0001cb   5208     rlr     0x8                              rlr             TempRam2
0001cc   5207     rlr     0x7                              rlr             TempRam1
                                           
0001cd   580f     movar   0xf                              movar           TempRam13
0001ce   4a09     rsubra  0x9                              rsubra          TempRam3
0001cf   580e     movar   0xe                              movar           TempRam12
0001d0   0e08     rsbcra  0x8                              rsbcra          TempRam2
0001d1   580d     movar   0xd                              movar           TempRam11
0001d2   0e07     rsbcra  0x7                              rsbcra          TempRam1
                                           
0001d3   e187     jbset   0x187, 0                         jbset           PFALG, 0
0001d4   000c     return                                   return
                                           _ProcAdd1_A:
0001d5   3c01     movai   0x1                              movai           1
0001d6   7e0c     addra   0xc                              addra           TempRam6
0001d7   3c00     movai   0                                movai           0
0001d8   120b     adcra   0xb                              adcra           TempRam5
0001d9   3c00     movai   0                                movai           0
0001da   120a     adcra   0xa                              adcra           TempRam4
0001db   000c     return                                   return
                                           
                                           ;**************************************************
                                           ;input  :       TempRam4,TempRam5, TempRam6
                                           ;               TempRam12,TempRam13
                                           ;output :       TempRam1,TempRam2,TempRam3,TempRam4,TempRam5,TempRam6
                                           ;need   :       buffer0 ,buffer1 ,buffer2,buffer3,buffer4,buffer5,Buffer6
                                           ;**************************************************
                                           _Mul3_2:
0001dc   7607     clrr    0x7                              clrr            TempRam1
0001dd   7608     clrr    0x8                              clrr            TempRam2
0001de   7609     clrr    0x9                              clrr            TempRam3
0001df   7600     clrr    0                                clrr            Buffer0
0001e0   7601     clrr    0x1                              clrr            Buffer1
0001e1   7602     clrr    0x2                              clrr            Buffer2
                                           
                                                           movff           Buffer3,TempRam4
                                                           movff           Buffer4,TempRam5
                                                           movff           Buffer5,TempRam6
                                           
0001e8   760a     clrr    0xa                              clrr            TempRam4
0001e9   760b     clrr    0xb                              clrr            TempRam5
0001ea   760c     clrr    0xc                              clrr            TempRam6
                                           
                                                           movfl           Buffer6, 16
0001ed   d187     bclr    0x187, 0                         bclr            PFALG, 0
                                           _Mul3_2Loop:
0001ee   4e0e     rrr     0xe                              rrr             TempRam12
0001ef   4e0f     rrr     0xf                              rrr             TempRam13
                                           
0001f0   e187     jbset   0x187, 0                         jbset           PFALG, 0
0001f1   a1fe     goto    0x1fe                            goto            _Mul3_2Loop1
                                           
0001f2   5805     movar   0x5                              movar           Buffer5
0001f3   7e0c     addra   0xc                              addra           TempRam6
                                           
0001f4   5804     movar   0x4                              movar           Buffer4
0001f5   120b     adcra   0xb                              adcra           TempRam5
                                           
0001f6   5803     movar   0x3                              movar           Buffer3
0001f7   120a     adcra   0xa                              adcra           TempRam4
                                           
0001f8   5802     movar   0x2                              movar           Buffer2
0001f9   1209     adcra   0x9                              adcra           TempRam3
                                           
0001fa   5801     movar   0x1                              movar           Buffer1
0001fb   1208     adcra   0x8                              adcra           TempRam2
                                           
0001fc   5800     movar   0                                movar           Buffer0
0001fd   1207     adcra   0x7                              adcra           TempRam1
                                           _Mul3_2Loop1:
0001fe   d187     bclr    0x187, 0                         bclr            PFALG, 0
0001ff   5205     rlr     0x5                              rlr             Buffer5
000200   5204     rlr     0x4                              rlr             Buffer4
000201   5203     rlr     0x3                              rlr             Buffer3
000202   5202     rlr     0x2                              rlr             Buffer2
000203   5201     rlr     0x1                              rlr             Buffer1
000204   5200     rlr     0                                rlr             Buffer0
                                           
000205   6a06     djzr    0x6                              djzr            Buffer6
000206   a1ee     goto    0x1ee                            goto            _Mul3_2Loop
000207   000c     return                                   return
                                           
                                           ;**************************************************
                                           ;Title  :       change to BCD code
                                           ;input  :       TempRam12, TempRam13
                                           ;Output :       TempRam2, TempRam3 ,TempRam4 ,TempRam5 ,TempRam6
                                           ;need   :       Buffer0,Buffer1,Buffer2
                                           ;**************************************************
                                           _Ftob:
000208   7608     clrr    0x8                              clrr            TempRam2
000209   7609     clrr    0x9                              clrr            TempRam3
00020a   760a     clrr    0xa                              clrr            TempRam4
00020b   760b     clrr    0xb                              clrr            TempRam5
00020c   760c     clrr    0xc                              clrr            TempRam6
                                           
                                                           movfl           Buffer0, 27H
                                                           movfl           Buffer1, 10H
                                           Sub10kLoop:
000211   5801     movar   0x1                              movar           Buffer1
000212   480f     rsubar  0xf                              rsubar          TempRam13
000213   5602     movra   0x2                              movra           Buffer2
                                           
000214   5800     movar   0                                movar           Buffer0
000215   0c0e     rsbcar  0xe                              rsbcar          TempRam12
                                           
000216   e187     jbset   0x187, 0                         jbset           PFALG, 0
000217   a21d     goto    0x21d                            goto            Sub1k
                                           
000218   560e     movra   0xe                              movra           TempRam12
                                                           movff           TempRam13,Buffer2
00021b   6608     incr    0x8                              incr            TempRam2
00021c   a211     goto    0x211                            goto            Sub10kLoop
                                           Sub1k:
                                                           movfl           Buffer0, 03H
                                                           movfl           Buffer1, 0E8H
                                           Sub1kLoop:
000221   5801     movar   0x1                              movar           Buffer1
000222   480f     rsubar  0xf                              rsubar          TempRam13
000223   5602     movra   0x2                              movra           Buffer2
                                           
000224   5800     movar   0                                movar           Buffer0
000225   0c0e     rsbcar  0xe                              rsbcar          TempRam12
                                           
000226   e187     jbset   0x187, 0                         jbset           PFALG, 0
000227   a22d     goto    0x22d                            goto            Sub100
000228   560e     movra   0xe                              movra           TempRam12
                                                           movff           TempRam13,Buffer2
00022b   6609     incr    0x9                              incr            TempRam3
00022c   a221     goto    0x221                            goto            Sub1kLoop
                                           Sub100:
00022d   7600     clrr    0                                clrr            Buffer0
                                                           movfl           Buffer1, 64H
                                           Sub100Loop:
000230   5801     movar   0x1                              movar           Buffer1
000231   480f     rsubar  0xf                              rsubar          TempRam13
000232   5602     movra   0x2                              movra           Buffer2
                                           
000233   5800     movar   0                                movar           Buffer0
000234   0c0e     rsbcar  0xe                              rsbcar          TempRam12
                                           
000235   e187     jbset   0x187, 0                         jbset           PFALG, 0
000236   a23c     goto    0x23c                            goto            Sub10
000237   560e     movra   0xe                              movra           TempRam12
                                                           movff           TempRam13,Buffer2
00023a   660a     incr    0xa                              incr            TempRam4
00023b   a230     goto    0x230                            goto            Sub100Loop
                                           Sub10:
                                                           movfl           Buffer1, 10
                                           sub10Loop:
00023e   5801     movar   0x1                              movar           Buffer1
00023f   480f     rsubar  0xf                              rsubar          TempRam13
                                           
000240   e187     jbset   0x187, 0                         jbset           PFALG, 0
000241   a245     goto    0x245                            goto            sub1
000242   560f     movra   0xf                              movra           TempRam13
000243   660b     incr    0xb                              incr            TempRam5
000244   a23e     goto    0x23e                            goto            sub10Loop
                                           sub1:
                                                           movff           TempRam6,TempRam13
000247   000c     return                                   return
                                           
                                           
                                                           ;#include         "e2prom.asm"
                                           
                                           ;**************************************************
                                           ;读内部数据
                                           ;**************************************************
                                           ReadBie:
000248   808a     call    0x8a                       call       delay1
000249   0000     nop                                nop
00024a   0000     nop                                        nop
00024b   000e     clrwdt                          	       	       	       	  CLRWDT
00024c   5989     movar   0x189                      movar    INDF3
00024d   567e     movra   0x7e                      movra    tempcal1
00024e   5983     movar   0x183                     movar    HIBYTE
00024f   567f     movra   0x7f                      movra    tempcal2
000250   808a     call    0x8a                      call       delay1
000251   000e     clrwdt                              CLRWDT
                                           
000252   0000     nop                                       nop
000253   0000     nop                                       nop
000254   6784     incr    0x184                     incr      FSR0
000255   5989     movar   0x189                     movar     INDF3
000256   5680     movra   0x80                      movra     tempcal3
000257   5983     movar   0x183                     movar     HIBYTE
000258   5681     movra   0x81                      movra     tempcal4
000259   6f84     decr    0x184                   	       	 DECR      FSR0
                                           
                                           
                                           
00025a   787e     andar   0x7e                              ANDAR     tempcal1
00025b   787f     andar   0x7f                             ANDAR     tempcal2
00025c   7880     andar   0x80                              ANDAR     tempcal3
00025d   7881     andar   0x81                    	       	       	       	 ANDAR     tempcal4
00025e   39ff     xorai   0xff                              XORAI     0FFH
                                                  	       	       	       	; XORAI     000H        ;test
00025f   000c     return                                    return
                                           ;*************************************************
                                           ;写内部数据
                                           ;*************************************************
                                           WriteBie:
000260   efad     jbset   0x1ad, 0x7              	       	jbset  	       	PUMP,7 	       	       	;4个TEST
000261   a260     goto    0x260                   	       	goto   	       	WriteBie
000262   000e     clrwdt                          	       	CLRWDT
000263   808a     call    0x8a                    	       	call   	       	delay1
000264   000e     clrwdt                          	       	CLRWDT
000265   efad     jbset   0x1ad, 0x7              	       	jbset  	       	PUMP,7
000266   a8a4     goto    0x8a4                   	       	goto   	       	CalErr3
000267   0000     nop                             	       	nop
000268   0000     nop                             	       	nop
000269   0000     nop                             	       	nop
00026a   584b     movar   0x4b                    	       	movar  	       	CalDot1H
00026b   5783     movra   0x183                   	       	movra  	       	HIBYTE
00026c   584a     movar   0x4a                    	       	movar  	       	CalDot1L
00026d   5789     movra   0x189                   	       	movra  	       	INDF3
00026e   808a     call    0x8a                    	       	call   	       	delay1
00026f   000e     clrwdt                          	       	CLRWDT
000270   efad     jbset   0x1ad, 0x7              	       	jbset  	       	PUMP,7
000271   a8a4     goto    0x8a4                   	       	goto   	       	CalErr3
                                           
000272   0000     nop                             	       	nop
000273   0000     nop                             	       	nop
000274   6784     incr    0x184                   	       	incr   	       	FSR0
000275   584d     movar   0x4d                    	       	movar  	       	CalDot2H
000276   5783     movra   0x183                   	       	movra  	       	HIBYTE
000277   584c     movar   0x4c                    	       	movar  	       	CalDot2L
000278   5789     movra   0x189                   	       	movra  	       	INDF3
000279   808a     call    0x8a                    	       	call   	       	delay1
00027a   000e     clrwdt                          	       	CLRWDT
00027b   efad     jbset   0x1ad, 0x7              	       	jbset  	       	PUMP,7
00027c   a8a4     goto    0x8a4                   	       	goto   	       	CalErr3
00027d   0000     nop                             	       	nop
00027e   0000     nop                             	       	nop
00027f   6784     incr    0x184                   	       	incr   	       	FSR0
000280   584f     movar   0x4f                    	       	movar  	       	CalDot3H
000281   5783     movra   0x183                   	       	movra  	       	HIBYTE
000282   584e     movar   0x4e                    	       	movar  	       	CalDot3L
000283   5789     movra   0x189                   	       	movra  	       	INDF3
                                           
000284   000c     return                                   return
                                           
                                                           ;#include         "GetCount.asm"
                                           ;**************************************************
                                           ;Title  : Proc from AD to Count
                                           ;Author : Kevin Lee
                                           ;Input  : TempRam3,TempRam4
                                           ;         CalDot1H,CalDot1L; CalDot2H,CalDot2L; CalDot3H,CalDot3L;CalCount1H,CalCount1L
                                           ;OutPut : CountH,CountL (0.25d)  TempRam3,TempRam4
                                           ;Date   : 2012/5/31 9:36
                                           ;**************************************************
                                           _GetCount:
                                           ;      	       	JBSET  	       	IOP0,0
                                           ;      	       	call   	       	GetZeroPoint
000285   80e7     call    0xe7                    	       	call   	       	CurAD_ZeroAD   	       	;HML_DR - ZeroHML
000286   dc15     bclr    0x15, 0x6               	       	bclr   	       	SysFlag1,NegFlag
000287   f187     jbclr   0x187, 0                	       	jbclr  	       	PFALG, 0
000288   a28d     goto    0x28d                   	       	goto   	       	_GetCount123
000289   cc15     bset    0x15, 0x6               	       	bset   	       	SysFlag1,NegFlag
00028a   7652     clrr    0x52                    	       	clrr   	       	CountH
00028b   7653     clrr    0x53                    	       	clrr   	       	CountL
00028c   000c     return                          	       	return
                                           _GetCount123:  	       	       	       	       	       	;HML_DR >= ZeroHML
                                                  	       	movff  	       	Reg1,CalCount1H
                                                  	       	movff  	       	Reg2,CalCount1L
                                           
                                                  	       	movff  	       	TempRam1,TempRam2
                                                  	       	movff  	       	TempRam2,TempRam3
                                           
                                                  	       	movff  	       	TempRam3,TempRam1
                                                  	       	movff  	       	TempRam4,TempRam2
                                           
                                                  	       	movff  	       	TempRam5,CalDot1H
                                                  	       	movff  	       	TempRam6,CalDot1L
00029d   8189     call    0x189                   	       	CALL   	       	_Sub2_2
00029e   e187     jbset   0x187, 0                	       	jbset  	       	PFALG, 0
00029f   a2bc     goto    0x2bc                   	       	GOTO   	       	GetCount1
0002a0   0000     nop                             	       	nop
                                                  	       	movff  	       	TempRam3,TempRam1
                                                  	       	movff  	       	TempRam4,TempRam2
                                                  	       	movff  	       	TempRam5,CalDot2H
                                                  	       	movff  	       	TempRam6,CalDot2L
0002a9   8189     call    0x189                   	       	CALL   	       	_Sub2_2
0002aa   e187     jbset   0x187, 0                	       	jbset  	       	PFALG, 0
0002ab   a2c7     goto    0x2c7                   	       	GOTO   	       	GetCount2
                                           
0002ac   d187     bclr    0x187, 0                	       	bclr   	       	PFALG, 0
0002ad   5237     rlr     0x37                    	       	RLR    	       	Reg2
0002ae   5236     rlr     0x36                    	       	RLR    	       	Reg1
0002af   584c     movar   0x4c                    	       	movar  	       	CalDot2L
0002b0   484e     rsubar  0x4e                    	       	RSUBAR 	       	CalDot3L
0002b1   5650     movra   0x50                    	       	movra  	       	CalConstL
                                           
0002b2   584d     movar   0x4d                    	       	movar  	       	CalDot2H
0002b3   0c4f     rsbcar  0x4f                    	       	RSBCAR 	       	CalDot3H
0002b4   5651     movra   0x51                    	       	movra  	       	CalConstH
                                           
0002b5   584c     movar   0x4c                    	       	movar  	       	CalDot2L
0002b6   4808     rsubar  0x8                     	       	RSUBAR 	       	TempRam2
0002b7   560c     movra   0xc                     	       	movra  	       	TempRam6
                                           
0002b8   584d     movar   0x4d                    	       	movar  	       	CalDot2H
0002b9   0c07     rsbcar  0x7                     	       	RSBCAR 	       	TempRam1
0002ba   560b     movra   0xb                     	       	movra  	       	TempRam5
0002bb   a2d3     goto    0x2d3                   	       	goto   	       	GetCount3
                                           GetCount1:
0002bc   7636     clrr    0x36                             clrr            Reg1
0002bd   7637     clrr    0x37                             clrr            Reg2
                                                           movff           CalConstH,CalDot1H
                                                           movff           CalConstL,CalDot1L
                                                           movff           TempRam5,TempRam1
                                                           movff           TempRam6,TempRam2
0002c6   a2d3     goto    0x2d3                            goto            GetCount3
                                           GetCount2:
0002c7   584a     movar   0x4a                             movar           CalDot1L
0002c8   484c     rsubar  0x4c                             RSUBAR           CalDot2L
0002c9   5650     movra   0x50                             movra           CalConstL
                                           
0002ca   584b     movar   0x4b                             movar           CalDot1H
0002cb   0c4d     rsbcar  0x4d                             RSBCAR          CalDot2H
0002cc   5651     movra   0x51                             movra           CalConstH
                                           
0002cd   584a     movar   0x4a                             movar           CalDot1L
0002ce   4808     rsubar  0x8                              RSUBAR           TempRam2
0002cf   560c     movra   0xc                              movra           TempRam6
                                           
0002d0   584b     movar   0x4b                             movar           CalDot1H
0002d1   0c07     rsbcar  0x7                              RSBCAR          TempRam1
0002d2   560b     movra   0xb                              movra           TempRam5
                                           ;...............
                                           GetCount3:
0002d3   760d     clrr    0xd                              clrr            TempRam11
                                                           movff           TempRam12,CalCount1H
                                                           movff           TempRam13,CalCount1L
                                           
0002d8   760a     clrr    0xa                              clrr            TempRam4
                                           
0002d9   d187     bclr    0x187, 0                         bclr            PFALG, 0
0002da   520c     rlr     0xc                              RLR             TempRam6
0002db   520b     rlr     0xb                              RLR             TempRam5
0002dc   520a     rlr     0xa                              RLR             TempRam4
                                           
0002dd   d187     bclr    0x187, 0                         bclr            PFALG, 0
0002de   520c     rlr     0xc                              RLR             TempRam6
0002df   520b     rlr     0xb                              RLR             TempRam5
0002e0   520a     rlr     0xa                              RLR             TempRam4
                                           
0002e1   81dc     call    0x1dc                            call            _Mul3_2
                                           
0002e2   760d     clrr    0xd                              clrr            TempRam11
                                                           movff           TempRam12,CalConstH
                                                           movff           TempRam13,CalConstL
0002e7   81aa     call    0x1aa                            call            _Div6_3
0002e8   81c9     call    0x1c9                            call            _ProcAdd1
                                           
                                                           movff           TempRam3,Reg1
                                                           movff           TempRam4,Reg2
                                           
0002ed   d187     bclr    0x187, 0                         bclr            PFALG, 0
0002ee   520a     rlr     0xa                              RLR             TempRam4
0002ef   5209     rlr     0x9                              RLR             TempRam3
                                           
0002f0   d187     bclr    0x187, 0                         bclr            PFALG, 0
0002f1   520a     rlr     0xa                              RLR             TempRam4
0002f2   5209     rlr     0x9                             RLR             TempRam3
                                           
0002f3   8184     call    0x184                            call            _Add2_2
                                           
                                                           movff           CountH,TempRam3
                                                           movff           CountL,TempRam4
                                           
0002f8   000c     return                                   return
                                           
                                           
                                                           ;#include         "Display_Weight.asm"
                                           ;************************************************
                                           ;Title  : Proc Display Weight
                                           ;Author : Kevin Lee
                                           ;Input  : TempRam12,TempRam13
                                           ;Date   : 2008-7-10 23:50
                                           ;*************************************************
                                           Display_Weight:
0002f9   e466     jbset   0x66, 0x2               	       	jbset  	       	SysFlag4,LockFlag
0002fa   a300     goto    0x300                   	       	goto   	       	Dsp_Weight_B
                                           
                                                           ; movff           TempRam12,LockCountH                  ;重量锁定
                                                           ; movff           TempRam13,LockCountL
                                                  	       	movff  	       	TempRam5,LockCountH                  ;重量锁定
                                                  	       	movff  	       	TempRam6,LockCountL
0002ff   a304     goto    0x304                   	       	goto   	       	Dsp_Weight_C
                                           
                                                            ;jbset           SysFlag2,GlintFlag                   ;中断闪烁亮
                                                            ;goto            Dsp_Weight_B
                                                           ; nop
                                                           ; return
                                           ;................................................
                                           Dsp_Weight_B:
                                                           movff           TempRam5,CountH     ;称重显示
                                                           movff           TempRam6,CountL
                                                          ; call            GetRealCount      ;为啥加2
                                           
                                           ;....................................................
                                           Dsp_Weight_C:
000304   f0cd     jbclr   0xcd, 0                          jbclr           UnitFlag,KgFlag
000305   a316     goto    0x316                            goto            Dsp_Weight_C1
                                           
000306   760a     clrr    0xa                              clrr            TempRam4                               ;kg换算lb
                                                           movfl           TempRam12, 2BH
                                                           movfl           TempRam13, 0FH                         ;11023
00030b   81dc     call    0x1dc                            call            _Mul3_2
00030c   760d     clrr    0xd                              clrr            TempRam11
                                                           movfl           TempRam12, 27H
                                                           movfl           TempRam13, 10H                         ;10000
000311   81aa     call    0x1aa                            call            _Div6_3
000312   81c9     call    0x1c9                            call            _ProcAdd1
                                           
000313   d187     bclr    0x187, 0                         bclr            C
000314   520c     rlr     0xc                              RLR             TempRam6
000315   520b     rlr     0xb                              RLR             TempRam5                               ;乘以2，精度为2g
                                           Dsp_Weight_C1:
                                                  	       	movff           TempRam12,TempRam5
                                                  	       	movff           TempRam13,TempRam6
                                           ;................................................
                                           Dsp_Weight_B1:
00031a   f4cd     jbclr   0xcd, 0x2                        jbclr           UnitFlag,StFlag                   ;ST标志位的到来
00031b   a326     goto    0x326                            goto            Dsp_Weight_St
                                           
00031c   8208     call    0x208                   	       	call            _Ftob                             ;查找BCD码
00031d   8464     call    0x464                   	       	call            Display_Num
00031e   815f     call    0x15f                   	       	call            Ram_To_Disp
                                           
00031f   c5c2     bset    0x1c2, 0x2                       bset            LCDDS0,2
                                           
000320   c1c2     bset    0x1c2, 0                	       	       	       	bset            LCDDS0,0
                                           
000321   e2cd     jbset   0xcd, 0x1               	       	       	       	jbset  	       	UnitFlag,LbFlag
000322   000c     return                          	       	        return
000323   d1c2     bclr    0x1c2, 0                	       	       	       	bclr            LCDDS0,0
000324   c1c5     bset    0x1c5, 0                	       	       	       	bset            LCDDS3,0
000325   000c     return                                    return
                                           ;..................................................
                                           Dsp_Weight_St:
000326   7608     clrr    0x8                              clrr            TempRam2
000327   7609     clrr    0x9                              clrr            TempRam3
000328   760a     clrr    0xa                              clrr            TempRam4
                                           
000329   3c04     movai   0x4                              movai           4
00032a   7e0c     addra   0xc                              ADDRA           TempRam6
00032b   3c00     movai   0                                movai           0                                   ;四舍五入
00032c   120b     adcra   0xb                              ADCRA          TempRam5
                                           
00032d   760d     clrr    0xd                              clrr            TempRam11
00032e   760e     clrr    0xe                              clrr            TempRam12
                                                           movfl           TempRam13, 140                      ;lb换算st
000331   81aa     call    0x1aa                            call            _Div6_3
                                           
                                                           movff           Reg1,TempRam2
                                                           movff           Reg2,TempRam3                       ;存放余数
                                           
                                                           movff           TempRam12,TempRam5
                                                           movff           TempRam13,TempRam6                  ;存放商
                                           
                                           
00033a   8208     call    0x208                            call            _Ftob                               ;转换成BCD码
                                           
                                                           movff           Display4,TempRam6
                                                           movff           Display3,TempRam5
                                           
                                                           movff           TempRam12,Reg1
                                                           movff           TempRam13,Reg2
                                           
000343   8208     call    0x208                            call            _Ftob                               ;转换成BCD码
                                           
                                                           movff           TempRam6,TempRam5
                                                           movff           TempRam5,TempRam4
                                           
                                                           movff           TempRam3,Display3
                                                           movff           TempRam4,Display4
                                           
00034c   7612     clrr    0x12                             clrr            Display3                             ;可不要
00034d   7613     clrr    0x13                             clrr            Display4
                                           
00034e   3c00     movai   0                                movai           0
00034f   4009     xorar   0x9                              XORAR           TempRam3
000350   e587     jbset   0x187, 0x2                       jbset           Z
000351   a354     goto    0x354                            goto            Dsp_Weight_St1
                                                           movfl           TempRam3,0x0a           ;清除没有的零
                                           Dsp_Weight_St1:
000354   3c00     movai   0                                movai           0
000355   400b     xorar   0xb                              XORAR           TempRam5
000356   e587     jbset   0x187, 0x2                       jbset           Z
000357   a35a     goto    0x35a                            goto            Dsp_Weight_St2
                                                           movfl           TempRam5,0x0a
                                           Dsp_Weight_St2:
00035a   8464     call    0x464                            call            Display_Num
00035b   815f     call    0x15f                            call            Ram_To_Disp
00035c   c1c8     bset    0x1c8, 0                	       	       	       	bset            LCDDS6,0
00035d   c5c5     bset    0x1c5, 0x2              	       	       	       	bset            LCDDS3,2
00035e   000c     return                                   return
                                           
                                                           ;#include         "Display_ADC.asm"
                                           ;**************************************************
                                           ;Title  : Display ADC
                                           ;Author : Kevin Lee
                                           ;Date   : 2008-7-13 10:20
                                           ;**************************************************
                                           Display_ADC:
00035f   e256     jbset   0x56, 0x1                        jbset           SysFlag3,DspCalFlag
000360   a371     goto    0x371                            goto            Display_ADC0
                                           
                                           Display_ADCCAL:
                                                           ;movfl           Display4,LcdchC
                                                           ;movfl           Display3,LcdchA
                                                           ;movfl           Display2,LcdchL
                                                           movfl           Display4,05H
                                                           movfl           Display3,05H
                                                           movfl           Display2,05H
000367   f054     jbclr   0x54, 0                          jbclr           TF1, 0
000368   000c     return                                   return
000369   f454     jbclr   0x54, 0x2                        jbclr           TF1, 2
00036a   3c03     movai   0x3                              movai           3
00036b   f654     jbclr   0x54, 0x3                        jbclr           TF1, 3
00036c   3c04     movai   0x4                              movai           4
00036d   f854     jbclr   0x54, 0x4                        jbclr           TF1, 4
00036e   3c05     movai   0x5                              movai           5
00036f   5610     movra   0x10                             movra           Display1
000370   000c     return                                   return
                                           
                                           ;**************************************************
                                           Display_ADC0:
000371   f054     jbclr   0x54, 0                          jbclr           TF1, 0
000372   a361     goto    0x361                            goto            Display_ADCCAL
                                           
000373   e254     jbset   0x54, 0x1                        jbset           TF1, 1
000374   a38f     goto    0x38f                            goto            Display_ADC1
                                           
                                                           movff           TempRam1,H_DR
                                                           movff           TempRam2,M_DR
                                                           movff           TempRam3,L_DR
                                                           movff           TempRam4,AmendZeroH
                                                           movff           TempRam5,AmendZeroM
                                                           movff           TempRam6,AmendZeroL
000381   8197     call    0x197                            call            _Sub3_3
                                                           ;call            _Neg3
                                           
000382   d187     bclr    0x187, 0                         bclr            PFALG, 0
000383   4e07     rrr     0x7                              rrr             TempRam1
000384   4e08     rrr     0x8                              rrr             TempRam2
000385   4e09     rrr     0x9                              rrr             TempRam3
                                           
                                                           movff           TempRam11,TempRam1
                                                           movff           TempRam12,TempRam2
                                                           movff           TempRam13,TempRam3
                                           
00038c   8208     call    0x208                            call            _Ftob
00038d   8464     call    0x464                            call            Display_Num
00038e   000c     return                                   return
                                           
                                           ;*************************************************
                                           Display_ADC1:
00038f   f454     jbclr   0x54, 0x2                        jbclr           TF1, 2
000390   a361     goto    0x361                            goto            Display_ADCCAL
                                           
                                           ;**************************************************
                                           Display_ADC2:
000391   80e7     call    0xe7                             call            CurAD_ZeroAD
                                                          ; call            _Neg3
                                           
000392   d187     bclr    0x187, 0                         bclr              PFALG, 0
000393   4e08     rrr     0x8                              rrr             TempRam2       	       	; 校磅内码数/2
000394   4e09     rrr     0x9                              rrr             TempRam3
                                           
                                                           movff           FtobH,TempRam2
                                                           movff           FtobL,TempRam3
000399   8208     call    0x208                            call            _Ftob
                                           
00039a   8464     call    0x464                            call            Display_Num
00039b   000c     return                                   return
                                           
                                           Lcd_Dis_Cal:
00039c   3c02     movai   0x2                     	       	movai  	       	0x02
00039d   5635     movra   0x35                    	       	movra  	       	Reg0
00039e   3cc0     movai   0xc0                    	       	movai  	       	0xc0
00039f   5607     movra   0x7                     	       	movra  	       	TempRam1
                                           
                                           Lcd_Dis_Cal1:
0003a0   5807     movar   0x7                     	       	movar  	       	TempRam1
0003a1   5785     movra   0x185                   	       	movra  	       	FSR1
0003a2   5813     movar   0x13                    	       	movar  	       	Display4
0003a3   5781     movra   0x181                   	       	movra  	       	INDF1  	       	       	;[D42:D40]->0X1C0
                                           
0003a4   6607     incr    0x7                              incr   	       	TempRam1
0003a5   4613     swapr   0x13                             swapr  	       	Display4
0003a6   5807     movar   0x7                              movar  	       	TempRam1
0003a7   5785     movra   0x185                            movra  	       	FSR1
0003a8   3c07     movai   0x7                     	       	movai  	       	0x07
0003a9   7813     andar   0x13                    	       	ANDAR  	       	Display4
0003aa   5781     movra   0x181                   	       	movra  	       	INDF1  	       	       	;[D46:D44]->0X1C1
                                           
0003ab   6607     incr    0x7                     	       	incr   	       	TempRam1
0003ac   d187     bclr    0x187, 0                	       	bclr   	       	C
0003ad   4e13     rrr     0x13                    	       	rrr    	       	Display4
0003ae   4e13     rrr     0x13                    	       	rrr    	       	Display4
0003af   5807     movar   0x7                     	       	movar  	       	TempRam1
0003b0   5785     movra   0x185                   	       	movra  	       	FSR1
0003b1   3c02     movai   0x2                     	       	movai  	       	0x02
0003b2   7813     andar   0x13                    	       	ANDAR  	       	Display4
0003b3   5781     movra   0x181                   	       	movra  	       	INDF1  	       	       	;[0,D47,0]->0X1C2
                                           
                                           Lcd_Dis_Cal2:
0003b4   3c02     movai   0x2                     	       	movai  	       	0x02
0003b5   5635     movra   0x35                    	       	movra  	       	Reg0
0003b6   3cc3     movai   0xc3                    	       	movai  	       	0xc3
0003b7   5607     movra   0x7                     	       	movra  	       	TempRam1
                                           
                                           Lcd_Dis_Cal3:
0003b8   5807     movar   0x7                     	       	movar  	       	TempRam1
0003b9   5785     movra   0x185                   	       	movra  	       	FSR1
0003ba   5812     movar   0x12                    	       	movar  	       	Display3
0003bb   5781     movra   0x181                   	       	movra  	       	INDF1  	       	       	;[D32:D30]->0X1C3
                                           
0003bc   6607     incr    0x7                     	       	incr   	       	TempRam1
0003bd   4612     swapr   0x12                    	       	swapr  	       	Display3
0003be   5807     movar   0x7                     	       	movar  	       	TempRam1
0003bf   5785     movra   0x185                   	       	movra  	       	FSR1
0003c0   3c07     movai   0x7                     	       	movai  	       	0x07
0003c1   7812     andar   0x12                    	       	ANDAR  	       	Display3
0003c2   5781     movra   0x181                   	       	movra  	       	INDF1  	       	       	;[D36:D34]->0X1C4
                                           
0003c3   6607     incr    0x7                     	       	incr   	       	TempRam1
0003c4   d187     bclr    0x187, 0                	       	bclr   	       	C
0003c5   4e12     rrr     0x12                    	       	rrr    	       	Display3
0003c6   4e12     rrr     0x12                    	       	rrr    	       	Display3
0003c7   5807     movar   0x7                     	       	movar  	       	TempRam1
0003c8   5785     movra   0x185                   	       	movra  	       	FSR1
0003c9   3c02     movai   0x2                     	       	movai  	       	0x02
0003ca   7812     andar   0x12                    	       	ANDAR  	       	Display3
0003cb   5781     movra   0x181                   	       	movra  	       	INDF1  	       	       	;[0,D37,0]->0X1C5
                                           
                                           Lcd_Dis_Cal4:
0003cc   3c02     movai   0x2                     	       	movai  	       	0x02
0003cd   5635     movra   0x35                    	       	movra  	       	Reg0
0003ce   3cc6     movai   0xc6                    	       	movai  	       	0xc6
0003cf   5607     movra   0x7                     	       	movra  	       	TempRam1
                                           Lcd_Dis_Cal5:
0003d0   5807     movar   0x7                     	       	movar  	       	TempRam1
0003d1   5785     movra   0x185                   	       	movra  	       	FSR1
0003d2   5811     movar   0x11                    	       	movar  	       	Display2
0003d3   5781     movra   0x181                   	       	movra  	       	INDF1
                                           
0003d4   6607     incr    0x7                     	       	incr   	       	TempRam1
0003d5   4611     swapr   0x11                    	       	swapr  	       	Display2
0003d6   5807     movar   0x7                     	       	movar  	       	TempRam1
0003d7   5785     movra   0x185                   	       	movra  	       	FSR1
0003d8   3c07     movai   0x7                     	       	movai  	       	0x07
0003d9   7811     andar   0x11                    	       	ANDAR  	       	Display2
0003da   5781     movra   0x181                   	       	movra  	       	INDF1
                                           
0003db   6607     incr    0x7                     	       	incr   	       	TempRam1
0003dc   d187     bclr    0x187, 0                	       	bclr   	       	C
0003dd   4e11     rrr     0x11                    	       	rrr    	       	Display2
0003de   4e11     rrr     0x11                    	       	rrr    	       	Display2
0003df   5807     movar   0x7                     	       	movar  	       	TempRam1
0003e0   5785     movra   0x185                   	       	movra  	       	FSR1
0003e1   3c02     movai   0x2                     	       	movai  	       	0x02
0003e2   7811     andar   0x11                    	       	ANDAR  	       	Display2
0003e3   5781     movra   0x181                   	       	movra  	       	INDF1
                                           
                                           Lcd_Dis_Cal6:
0003e4   3c02     movai   0x2                     	       	movai  	       	0x02
0003e5   5635     movra   0x35                    	       	movra  	       	Reg0
0003e6   3cc9     movai   0xc9                    	       	movai  	       	0xc9
0003e7   5607     movra   0x7                     	       	movra  	       	TempRam1
                                           Lcd_Dis_Cal7:
0003e8   5807     movar   0x7                     	       	movar  	       	TempRam1
0003e9   5785     movra   0x185                   	       	movra  	       	FSR1
0003ea   5810     movar   0x10                    	       	movar  	       	Display1
0003eb   5781     movra   0x181                   	       	movra  	       	INDF1
                                           
0003ec   6607     incr    0x7                     	       	incr   	       	TempRam1
0003ed   4610     swapr   0x10                    	       	swapr  	       	Display1
0003ee   5807     movar   0x7                     	       	movar  	       	TempRam1
0003ef   5785     movra   0x185                   	       	movra  	       	FSR1
0003f0   3c07     movai   0x7                     	       	movai  	       	0x07
0003f1   7810     andar   0x10                    	       	ANDAR  	       	Display1
0003f2   5781     movra   0x181                   	       	movra  	       	INDF1
                                           
0003f3   6607     incr    0x7                     	       	incr   	       	TempRam1
0003f4   d187     bclr    0x187, 0                	       	bclr   	       	C
0003f5   4e10     rrr     0x10                    	       	rrr    	       	Display1
0003f6   4e10     rrr     0x10                    	       	rrr    	       	Display1
0003f7   5807     movar   0x7                     	       	movar  	       	TempRam1
0003f8   5785     movra   0x185                   	       	movra  	       	FSR1
0003f9   3c02     movai   0x2                     	       	movai  	       	0x02
0003fa   7810     andar   0x10                    	       	ANDAR  	       	Display1
0003fb   5781     movra   0x181                   	       	movra  	       	INDF1
                                           
0003fc   000c     return                          	       	return
                                           
                                           
                                           Lcd_Dis_Sys:
0003fd   3c02     movai   0x2                              movai           0x02
0003fe   5635     movra   0x35                             movra           Reg0
0003ff   3cc0     movai   0xc0                             movai           0xc0
000400   5607     movra   0x7                              movra           TempRam1
                                           Lcd_Dis_Sys1:
                                           
000401   5807     movar   0x7                              movar           TempRam1
000402   5785     movra   0x185                            movra           FSR1
000403   5813     movar   0x13                             movar           Display4
000404   5781     movra   0x181                            movra           INDF1
                                           
000405   6607     incr    0x7                              incr            TempRam1
000406   4613     swapr   0x13                             swapr           Display4
000407   5807     movar   0x7                              movar           TempRam1
000408   5785     movra   0x185                            movra           FSR1
000409   3c07     movai   0x7                     	       	movai          0x07
00040a   7813     andar   0x13                    	       	ANDAR          Display4
00040b   5781     movra   0x181                            movra          INDF1
                                           
00040c   6607     incr    0x7                     	       	incr   	       	TempRam1
00040d   d187     bclr    0x187, 0                	       	bclr   	       	C
00040e   4e13     rrr     0x13                    	       	rrr    	       	Display4
00040f   4e13     rrr     0x13                    	       	rrr    	       	Display4
000410   5807     movar   0x7                     	       	movar  	       	TempRam1
000411   5785     movra   0x185                   	       	movra  	       	FSR1
000412   3c02     movai   0x2                     	       	movai  	       	0x02
000413   7813     andar   0x13                    	       	ANDAR  	       	Display4
000414   5781     movra   0x181                   	       	movra  	       	INDF1
000415   000c     return                          	       	return
                                           
                                                           ;#include         "Display.asm"
                                           ;**************************************************
                                           ;确定要显示的是哪个数！
                                           ;**************************************************
                                           Lcd_Num:
                                           
000416   5640     movra   0x40                    movra    DspData1
000417   3a00     isubai  0                       isubai   0x00
000418   f587     jbclr   0x187, 0x2              jbclr    Z
000419   8443     call    0x443                   call     lcd_disp0
                                           
00041a   5840     movar   0x40                    movar    DspData1
00041b   3a01     isubai  0x1                     isubai   0x01
00041c   f587     jbclr   0x187, 0x2              jbclr    Z
00041d   8446     call    0x446                   call     lcd_disp1
                                           
00041e   5840     movar   0x40                    movar    DspData1
00041f   3a02     isubai  0x2                     isubai   0x02
000420   f587     jbclr   0x187, 0x2              jbclr    Z
000421   8449     call    0x449                   call     lcd_disp2
                                           
000422   5840     movar   0x40                    movar    DspData1
000423   3a03     isubai  0x3                     isubai   0x03
000424   f587     jbclr   0x187, 0x2              jbclr    Z
000425   844c     call    0x44c                   call     lcd_disp3
                                           
000426   5840     movar   0x40                    movar    DspData1
000427   3a04     isubai  0x4                     isubai   0x04
000428   f587     jbclr   0x187, 0x2              jbclr    Z
000429   844f     call    0x44f                   call     lcd_disp4
                                           
00042a   5840     movar   0x40                    movar    DspData1
00042b   3a05     isubai  0x5                     isubai   0x05
00042c   f587     jbclr   0x187, 0x2              jbclr    Z
00042d   8452     call    0x452                   call     lcd_disp5
                                           
00042e   5840     movar   0x40                    movar    DspData1
00042f   3a06     isubai  0x6                     isubai   0x06
000430   f587     jbclr   0x187, 0x2              jbclr    Z
000431   8455     call    0x455                   call     lcd_disp6
                                           
000432   5840     movar   0x40                    movar    DspData1
000433   3a07     isubai  0x7                     isubai   0x07
000434   f587     jbclr   0x187, 0x2              jbclr    Z
000435   8458     call    0x458                   call     lcd_disp7
                                           
000436   5840     movar   0x40                    movar    DspData1
000437   3a08     isubai  0x8                     isubai   0x08
000438   f587     jbclr   0x187, 0x2              jbclr    Z
000439   845b     call    0x45b                   call     lcd_disp8
                                           
00043a   5840     movar   0x40                    movar    DspData1
00043b   3a09     isubai  0x9                     isubai   0x09
00043c   f587     jbclr   0x187, 0x2              jbclr    Z
00043d   845e     call    0x45e                   call     lcd_disp9
                                           
00043e   5840     movar   0x40                    movar    DspData1
00043f   3a0a     isubai  0xa                     isubai   0x0a
000440   f587     jbclr   0x187, 0x2              jbclr    Z
000441   8461     call    0x461                   call     lcd_disp_null
                                           
000442   000c     return                          return
                                           
                                           ;=========================================================
                                           
                                           
                                           lcd_disp0:
                                           
000443   3cd7     movai   0xd7                    	movai   11010111b
000444   563f     movra   0x3f                     movra   DspData
000445   000c     return                           return
                                           lcd_disp1:
                                           
000446   3c03     movai   0x3                     	movai   00000011b
000447   563f     movra   0x3f                     movra   DspData
000448   000c     return                           return
                                           lcd_disp2:
                                           
000449   3c75     movai   0x75                    	movai   01110101b
00044a   563f     movra   0x3f                     movra   DspData
00044b   000c     return                           return
                                           lcd_disp3:
                                           
00044c   3c37     movai   0x37                    	movai   00110111b
00044d   563f     movra   0x3f                     movra   DspData
00044e   000c     return                           return
                                           lcd_disp4:
00044f   3ca3     movai   0xa3                     movai   10100011b
000450   563f     movra   0x3f                     movra   DspData
000451   000c     return                           return
                                           lcd_disp5:
000452   3cb6     movai   0xb6                     movai   10110110b
000453   563f     movra   0x3f                     movra   DspData
000454   000c     return                           return
                                           lcd_disp6:
000455   3cf6     movai   0xf6                     movai   11110110b
000456   563f     movra   0x3f                     movra   DspData
000457   000c     return                           return
                                           lcd_disp7:
000458   3c13     movai   0x13                     movai   00010011b
000459   563f     movra   0x3f                     movra   DspData
00045a   000c     return                           return
                                           lcd_disp8:
00045b   3cf7     movai   0xf7                     movai   11110111b
00045c   563f     movra   0x3f                     movra   DspData
00045d   000c     return                           return
                                           lcd_disp9:
00045e   3cb7     movai   0xb7                     movai   10110111b
00045f   563f     movra   0x3f                     movra   DspData
000460   000c     return                           return
                                           lcd_disp_null:
000461   3c00     movai   0                        movai   00000000b
000462   563f     movra   0x3f                     movra   DspData
000463   000c     return                           return
                                           
                                           ;**************************************************
                                           ;十六进制转十进制时的显示
                                           ;**************************************************
                                           Display_Num:
000464   3c00     movai   0                                movai           0x00
000465   4009     xorar   0x9                              xorar           TempRam3
000466   e587     jbset   0x187, 0x2                       jbset           Z
000467   a470     goto    0x470                            goto            Display_Num1
000468   3c0a     movai   0xa                              movai           0x0a
000469   5609     movra   0x9                              movra           TempRam3
                                           
                                           
00046a   3c00     movai   0                                movai           0x00
00046b   400a     xorar   0xa                              xorar           TempRam4
00046c   e587     jbset   0x187, 0x2                       jbset           Z
00046d   a470     goto    0x470                            goto            Display_Num1
00046e   3c0a     movai   0xa                              movai           0x0a
00046f   560a     movra   0xa                              movra           TempRam4
                                           
                                                        ;   movai           0x00
                                                        ;   xorar           TempRam5
                                                        ;   jbset           Z
                                                        ;   goto            Display_Num1
                                                        ;   movai           10
                                                        ;   movra           TempRam5
                                           
                                           Display_Num1:
000470   5809     movar   0x9                              movar           TempRam3
000471   8416     call    0x416                            call            Lcd_Num
000472   583f     movar   0x3f                             movar           DspData
000473   5610     movra   0x10                             movra           Display1
                                           
                                           
000474   580a     movar   0xa                              movar           TempRam4
000475   8416     call    0x416                            call            Lcd_Num
000476   583f     movar   0x3f                             movar           DspData
000477   5611     movra   0x11                             movra           Display2
                                           
000478   580b     movar   0xb                              movar           TempRam5
000479   8416     call    0x416                            call            Lcd_Num
00047a   583f     movar   0x3f                             movar           DspData
00047b   5612     movra   0x12                             movra           Display3
                                           
00047c   580c     movar   0xc                              movar           TempRam6
00047d   8416     call    0x416                            call            Lcd_Num
00047e   583f     movar   0x3f                             movar           DspData
00047f   5613     movra   0x13                             movra           Display4
                                           
000480   000c     return                                   return
                                           ;*************************************************
                                           ;清显示缓冲
                                           ;*************************************************
                                           ClrLCDBuffer:
000481   3c00     movai   0                                movai           0x00
000482   a484     goto    0x484                            goto            DisplayCom
                                           FullDspBuffer:
000483   3cff     movai   0xff                             movai           0xff
                                           DisplayCom:
000484   5614     movra   0x14                             movra           DisplayFs1
                                           DisplayCom1:
000485   5610     movra   0x10                             movra           Display1
000486   5611     movra   0x11                             movra           Display2
000487   5612     movra   0x12                             movra           Display3
000488   5613     movra   0x13                             movra           Display4
                                           
000489   000c     return                                   return
                                           ;**************************************************
                                           ;装载显示，display-->tempram,tempram-->lcd1&lcd0-->显示，，，
                                           ;**************************************************
                                           LoadDspData:   	       	       	       	       	;Display1-4 -> LCDDS2-9
00048a   3c07     movai   0x7                     	       	movai  	       	0x07
00048b   5635     movra   0x35                    	       	movra  	       	Reg0
00048c   3cc0     movai   0xc0                    	       	movai  	       	0xc0   	       	;LCDDS4;
00048d   5607     movra   0x7                     	       	movra  	       	TempRam1
                                           
00048e   3c10     movai   0x10                    	       	movai  	       	Display1
00048f   5608     movra   0x8                     	       	movra  	       	TempRam2
000490   5784     movra   0x184                   	       	movra  	       	FSR0
                                           ;======================
                                           LoadDspDataLoop1:
000491   5980     movar   0x180                   	       	movar  	       	INDF0
000492   5609     movra   0x9                     	       	movra  	       	TempRam3
000493   5807     movar   0x7                     	       	movar  	       	TempRam1
000494   5785     movra   0x185                   	       	movra  	       	FSR1
000495   5809     movar   0x9                     	       	movar           TempRam3
000496   5781     movra   0x181                   	       	movra           INDF1
                                           
000497   6607     incr    0x7                     	       	incr            TempRam1
000498   4609     swapr   0x9                     	       	swapr           TempRam3
000499   5807     movar   0x7                     	       	movar           TempRam1
00049a   5785     movra   0x185                   	       	movra           FSR1
00049b   5809     movar   0x9                     	       	movar           TempRam3
00049c   5781     movra   0x181                   	       	movra           INDF1
                                           
00049d   6607     incr    0x7                     	       	incr            TempRam1
00049e   6608     incr    0x8                     	       	incr            TempRam2
00049f   5808     movar   0x8                     	       	movar           TempRam2
0004a0   5784     movra   0x184                   	       	movra           FSR0
                                           
0004a1   6a35     djzr    0x35                    	       	djzr            Reg0
0004a2   a491     goto    0x491                   	       	goto            LoadDspDataLoop1
0004a3   000c     return                          	       	return
                                           
                                           ;*************************
                                           Lcd_Dis:
0004a4   3c02     movai   0x2                              movai           0x02
0004a5   5635     movra   0x35                             movra           Reg0
0004a6   3cc0     movai   0xc0                             movai           0xc0
0004a7   5607     movra   0x7                              movra           TempRam1
                                           Lcd_Dis1:
0004a8   5807     movar   0x7                              movar           TempRam1
0004a9   5785     movra   0x185                            movra           FSR1
0004aa   5813     movar   0x13                             movar           Display4
0004ab   5781     movra   0x181                            movra           INDF1
                                           
0004ac   6607     incr    0x7                              incr            TempRam1
0004ad   4613     swapr   0x13                             swapr           Display4
0004ae   5807     movar   0x7                              movar           TempRam1
0004af   5785     movra   0x185                            movra           FSR1
0004b0   3c07     movai   0x7                     	       	movai          0x07
0004b1   7813     andar   0x13                    	       	ANDAR          Display4
0004b2   5781     movra   0x181                            movra          INDF1
                                           
0004b3   6607     incr    0x7                     	       	incr            TempRam1
0004b4   d187     bclr    0x187, 0                	       	bclr            C
0004b5   4e13     rrr     0x13                    	       	rrr             Display4
0004b6   4e13     rrr     0x13                    	       	rrr             Display4
0004b7   5807     movar   0x7                     	        movar           TempRam1
0004b8   5785     movra   0x185                            movra           FSR1
0004b9   3c02     movai   0x2                     	       	movai          0x02
0004ba   7813     andar   0x13                    	       	ANDAR          Display4
0004bb   5f81     orra    0x181                            ORRA           INDF1
                                           
                                           Lcd_Dis2:
0004bc   3c02     movai   0x2                              movai           0x02
0004bd   5635     movra   0x35                             movra           Reg0
0004be   3cc3     movai   0xc3                             movai           0xc3
0004bf   5607     movra   0x7                              movra           TempRam1
                                           Lcd_Dis3:
0004c0   5807     movar   0x7                              movar           TempRam1
0004c1   5785     movra   0x185                            movra           FSR1
0004c2   5812     movar   0x12                             movar           Display3
0004c3   5781     movra   0x181                            movra           INDF1
                                           
0004c4   6607     incr    0x7                              incr            TempRam1
0004c5   4612     swapr   0x12                             swapr           Display3
0004c6   5807     movar   0x7                              movar           TempRam1
0004c7   5785     movra   0x185                            movra           FSR1
0004c8   3c07     movai   0x7                     	       	movai          0x07
0004c9   7812     andar   0x12                    	       	ANDAR          Display3
0004ca   5781     movra   0x181                            movra          INDF1
                                           
0004cb   6607     incr    0x7                     	       	incr            TempRam1
0004cc   d187     bclr    0x187, 0                	       	bclr            C
0004cd   4e12     rrr     0x12                    	        rrr             Display3
0004ce   4e12     rrr     0x12                    	       	rrr             Display3
0004cf   5807     movar   0x7                     	       	movar           TempRam1
0004d0   5785     movra   0x185                            movra           FSR1
0004d1   3c02     movai   0x2                     	       	movai          0x02
0004d2   7812     andar   0x12                    	       	ANDAR          Display3
0004d3   5f81     orra    0x181                            ORRA           INDF1
                                           
                                           Lcd_Dis4:
0004d4   3c02     movai   0x2                              movai           0x02
0004d5   5635     movra   0x35                             movra           Reg0
0004d6   3cc6     movai   0xc6                             movai           0xc6
0004d7   5607     movra   0x7                              movra           TempRam1
                                           Lcd_Dis5:
0004d8   5807     movar   0x7                              movar           TempRam1
0004d9   5785     movra   0x185                            movra           FSR1
0004da   5811     movar   0x11                             movar           Display2
0004db   5781     movra   0x181                            movra           INDF1
0004dc   6607     incr    0x7                              incr            TempRam1
0004dd   4611     swapr   0x11                             swapr           Display2
0004de   5807     movar   0x7                              movar           TempRam1
0004df   5785     movra   0x185                            movra           FSR1
                                           
0004e0   3c07     movai   0x7                     	       	movai          0x07
0004e1   7811     andar   0x11                    	       	ANDAR          Display2
0004e2   5781     movra   0x181                            movra          INDF1
                                           
0004e3   6607     incr    0x7                     	       	incr            TempRam1
0004e4   d187     bclr    0x187, 0                	       	bclr            C
0004e5   4e11     rrr     0x11                    	       	rrr             Display2
0004e6   4e11     rrr     0x11                    	       	rrr             Display2
0004e7   5807     movar   0x7                     	       	movar           TempRam1
0004e8   5785     movra   0x185                            movra           FSR1
                                           
0004e9   3c02     movai   0x2                     	       	movai          0x02
0004ea   7811     andar   0x11                    	       	ANDAR          Display2
0004eb   5f81     orra    0x181                            ORRA           INDF1
                                           
                                           Lcd_Dis6:
0004ec   3c02     movai   0x2                              movai           0x02
0004ed   5635     movra   0x35                             movra           Reg0
0004ee   3cc9     movai   0xc9                             movai           0xc9
0004ef   5607     movra   0x7                              movra           TempRam1
                                           Lcd_Dis7:
0004f0   5807     movar   0x7                              movar           TempRam1
0004f1   5785     movra   0x185                            movra           FSR1
0004f2   5810     movar   0x10                             movar           Display1
0004f3   5781     movra   0x181                            movra           INDF1
                                           
0004f4   6607     incr    0x7                              incr            TempRam1
0004f5   4610     swapr   0x10                             swapr           Display1
0004f6   5807     movar   0x7                              movar           TempRam1
0004f7   5785     movra   0x185                            movra           FSR1
0004f8   3c07     movai   0x7                     	       	movai          0x07
0004f9   7810     andar   0x10                    	        ANDAR          Display1
0004fa   5781     movra   0x181                            movra          INDF1
                                           
0004fb   6607     incr    0x7                     	       	incr            TempRam1
0004fc   d187     bclr    0x187, 0                	       	bclr            C
0004fd   4e10     rrr     0x10                    	       	rrr             Display1
0004fe   4e10     rrr     0x10                    	       	rrr             Display1
0004ff   5807     movar   0x7                     	       	movar           TempRam1
000500   5785     movra   0x185                            movra           FSR1
000501   3c02     movai   0x2                     	        movai          0x02
000502   7810     andar   0x10                    	       	ANDAR          Display1
000503   5f81     orra    0x181                            ORRA           INDF1
                                           
                                           Unit_Dis:
000504   f0cd     jbclr   0xcd, 0                          jbclr           UnitFlag,KgFlag
000505   a50a     goto    0x50a                   	       	goto            Unit_DisKG
000506   f4cd     jbclr   0xcd, 0x2               	       	jbclr           UnitFlag,StFlag
000507   a511     goto    0x511                   	       	goto            Unit_DisST
000508   f2cd     jbclr   0xcd, 0x1               	       	jbclr  	       	UnitFlag,LbFlag
000509   a50d     goto    0x50d                   	       	goto            Unit_DisLB
                                           
                                           Unit_DisKG:
00050a   c5c2     bset    0x1c2, 0x2                       bset            LCDDS0,2
00050b   c1c2     bset    0x1c2, 0                	       	bset            LCDDS0,0
00050c   000c     return                          	       	return
                                           
                                           Unit_DisLB:
00050d   d1c2     bclr    0x1c2, 0                         bclr            LCDDS0,0
00050e   c5c2     bset    0x1c2, 0x2              	       	bset            LCDDS0,2
00050f   c1c5     bset    0x1c5, 0                	       	bset            LCDDS3,0
000510   000c     return                          	       	return
                                           
                                           Unit_DisST:
000511   c1c8     bset    0x1c8, 0                         bset            LCDDS6,0
000512   c5c5     bset    0x1c5, 0x2              	       	bset            LCDDS3,2
000513   000c     return                                   return
                                           
                                           
                                           ;..................................................
                                           ;看门狗唤醒处理
                                           ;..................................................
                                           WDTWankenUp:
                                                  	       	;#include      	"WDTWakenUp.asm"
                                           ;************************************************
                                           ;Title  : 看门狗唤醒处理
                                           ;Author : Kevin Lee
                                           ;Date   : 2009-9-9 14:18
                                           ;************************************************
000514   eb88     jbset   0x188, 0x5              	       	jbset  	       	MCR, 5
000515   a989     goto    0x989                   	       	goto   	       	goto_allstop
000516   db88     bclr    0x188, 0x5              	       	bclr   	       	MCR, 5
000517   000e     clrwdt                          	       	clrwdt
                                           
                                           TestWdtIn:
000518   db88     bclr    0x188, 0x5              	       	bclr   	       	MCR, 5
000519   c2cc     bset    0xcc, 0x1               	       	bset   	       	AutoOn_Flags,WdtWaken_Flag
                                           
                                           ;..................................................
                                           WDTClock:
00051a   c215     bset    0x15, 0x1               	       	bset   	       	SysFlag1,AdcStartFlag
00051b   763c     clrr    0x3c                    	       	clrr   	       	SampleTimes
                                           
00051c   dc6f     bclr    0x6f, 0x6               	       	bclr   	       	SysFlag5,WdtTrackSFlag
00051d   de6f     bclr    0x6f, 0x7               	       	bclr   	       	SysFlag5,WdtTrackBFlag
                                                  	       	movfl  	       	WakenUpCount,43
                                                  	       	movfl  	       	TF1, 10
                                           
                                           ;************************************************
                                           WDTWakenUpLoop:
000522   d015     bclr    0x15, 0                 	       	bclr   	       	SysFlag1,WdtProcADFlag
                                           
                                           ;......
                                           WDTWakenUpLoop1:
000523   dfa0     bclr    0x1a0, 0x7              	       	bclr   	       	T0CR,7 	       	       	;关T0
000524   cbb0     bset    0x1b0, 0x5              	       	bset   	       	ADCR0,5	       	       	;开PGA
000525   cfb0     bset    0x1b0, 0x7              	       	bset   	       	ADCR0,7        	       	;开ADC
000526   cf88     bset    0x188, 0x7              	       	bset   	       	MCR,7  	       	       	;GIE=1
000527   cdad     bset    0x1ad, 0x6              	       	bset   	       	PUMP,6 	       	       	;开PUMP
                                           
000528   3c40     movai   0x40                    	       	movai  	       	40H
000529   578a     movra   0x18a                   	       	movra  	       	INTE   	       	       	;ADIE=1
00052a   3c00     movai   0                       	       	movai  	       	0x00
00052b   578b     movra   0x18b                   	       	movra  	       	INTF
00052c   cfa0     bset    0x1a0, 0x7              	       	bset   	       	T0CR,7 	       	       	;开T0
00052d   3c07     movai   0x7                     	       	movai  	       	0x07
00052e   57b1     movra   0x1b1                   	       	movra  	       	ADCR1          	;77=65536,128  57=16384,128  37=4096,128 采样时间16ms@2M?
00052f   3cc0     movai   0xc0                    	       	movai  	       	0xc0
000530   57b2     movra   0x1b2                   	       	movra  	       	ADCR2
000531   3cc0     movai   0xc0                    	       	movai  	       	0xc0
000532   57b2     movra   0x1b2                   	       	movra  	       	ADCR2  	       	       	;?
                                           
000533   c1ae     bset    0x1ae, 0                	       	bset   	       	OSCM,0 	       	       	;高频一直开
000534   d3ae     bclr    0x1ae, 0x1              	       	BCLR   	       	OSCM,1 	       	       	;低频休眠停振
000535   d5ae     bclr    0x1ae, 0x2              	       	BCLR   	       	OSCM,2 	       	       	;系统高频工作
000536   3c58     movai   0x58                    	       	movai  	       	0x58
000537   57b3     movra   0x1b3                   	       	movra  	       	TPSC   	       	       	;LDO开 2.5V,基准电压开
                                           ;*******************************
                                           WDT_WAIT:
                                           
                                           WDT_STOP:
000538   c1ae     bset    0x1ae, 0                	       	bset   	       	OSCM,0 	       	       	;高频一直开
000539   d3ae     bclr    0x1ae, 0x1              	       	bclr   	       	OSCM,1 	       	       	;低频休眠停振
00053a   d5ae     bclr    0x1ae, 0x2              	       	bclr   	       	OSCM,2 	       	       	;系统高频工作
00053b   3c00     movai   0                       	       	movai  	       	0x00
00053c   578b     movra   0x18b                   	       	movra  	       	INTF
00053d   000e     clrwdt                          	       	CLRWDT
00053e   0000     nop                             	       	NOP
00053f   000b     stop                            	       	stop   	       	       	       	       	;ADC能唤醒进中断
000540   0000     nop                             	       	nop
000541   0000     nop                             	       	nop
000542   0000     nop                             	       	nop    	       	       	       	       	;唤醒后系统高频工作
000543   000e     clrwdt                          	       	CLRWDT
000544   cf88     bset    0x188, 0x7              	       	bset   	       	MCR,7  	       	       	;GIE=1
                                           wait_adifE:
000545   e415     jbset   0x15, 0x2               	       	jbset  	       	SysFlag1,AdcOkFlag
000546   a538     goto    0x538                   	       	goto   	       	WDT_WAIT
                                           
000547   c015     bset    0x15, 0                 	       	bset   	       	SysFlag1,WdtProcADFlag
000548   d415     bclr    0x15, 0x2               	       	bclr   	       	SysFlag1,AdcOkFlag
                                           
000549   58d2     movar   0xd2                    	       	movar  	       	AutoOnADL
00054a   4829     rsubar  0x29                    	       	RSUBAR 	       	ADRamM
00054b   58d1     movar   0xd1                    	       	movar  	       	AutoOnADH
00054c   0c28     rsbcar  0x28                    	       	RSBCAR 	       	ADRamH
                                           
00054d   f187     jbclr   0x187, 0                	       	jbclr  	       	C
00054e   a550     goto    0x550                   	       	goto   	       	WDTWakenUp0
                                           
00054f   a989     goto    0x989                   	       	goto            goto_allstop   	       	;AD值小于开机显示门限
                                           
                                           ;................................................
                                           WDTWakenUp0:   	       	       	       	       	       	;AD值超过开机显示门限
000550   fc6f     jbclr   0x6f, 0x6               	       	jbclr  	       	SysFlag5,WdtTrackSFlag
000551   a989     goto    0x989                   	       	goto   	       	goto_allstop
                                           
000552   ce6f     bset    0x6f, 0x7               	       	bset   	       	SysFlag5,WdtTrackBFlag
000553   6a70     djzr    0x70                    	       	DJZR   	       	WakenUpCount   	       	; 连续50次AD都大于开机重量的AD才开机
000554   a522     goto    0x522                   	       	goto   	       	WDTWakenUpLoop
000555   a556     goto    0x556                   	       	goto   	       	WDTWakenUp1
                                           
                                           ;................................................
                                           WDTWakenUp1:
000556   c0cc     bset    0xcc, 0                 	       	bset   	       	AutoOn_Flags,WakenOn_Flag      	; 重力开机标志
                                           
                                           ;................................................
                                           WDTWakenUp2:
000557   000e     clrwdt                          	       	clrwdt
000558   d2cc     bclr    0xcc, 0x1               	       	bclr   	       	AutoOn_Flags,WdtWaken_Flag
000559   d866     bclr    0x66, 0x4               	       	bclr   	       	SysFlag4,LowBatFlag
00055a   d015     bclr    0x15, 0                 	       	bclr   	       	SysFlag1,WdtProcADFlag
                                           
                                           ;************************************************
                                           WDTWakenUpEnd:
00055b   a566     goto    0x566                   	       	goto   	       	SysInit1
                                           
                                           ;************************************************
                                           ;上电复位处理
                                           ;************************************************
                                           SysInit:
00055c   3c95     movai   0x95                    	       	movai  	       	0x95
00055d   5784     movra   0x184                   	       	movra  	       	FSR0
00055e   7780     clrr    0x180            rst_clr	       	clrr   	       	INDF0  	   	   	;clr 0x95-0xd4
00055f   6784     incr    0x184                   	       	incr   	       	FSR0
000560   3cd5     movai   0xd5                    	       	movai  	       	0xd5
000561   4984     rsubar  0x184                   	       	rsubar 	       	FSR0
000562   e187     jbset   0x187, 0                	       	jbset  	       	C
000563   a55e     goto    0x55e                   	       	goto   	       	rst_clr
                                           
000564   3c01     movai   0x1                     	       	movai  	       	0x01
000565   56cd     movra   0xcd                    	       	movra  	       	UnitFlag
                                           
                                           ;************************************************
                                           SysInit1:
                                                           ;#include         "sys_init.asm"
                                           sys_init:
000566   3c30     movai   0x30                    	       	movai  	       	0x30
000567   57ae     movra   0x1ae                   	       	movra  	       	OSCM   	   	   	;系统高频工作,高/低频休眠停振
000568   808a     call    0x8a                    	       	call   	       	delay1
000569   3c63     movai   0x63                    	       	movai  	       	0x63
00056a   57ad     movra   0x1ad                   	       	movra  	       	PUMP   	   	   	;开PUMP,选择高频时钟,烧录电压7.5V,电压受VLCDX控制,LCD电压3.0V
00056b   808a     call    0x8a                    	       	call   	       	delay1
00056c   3c58     movai   0x58                    	       	movai  	       	0x58
00056d   57b3     movra   0x1b3                   	       	movra  	       	TPSC   	       	       	;开LDO 2.5V,开基准电压   	;0x78=2.3V,0x58=2.5V,0x38=2.8V,0x18=3.0V
00056e   808a     call    0x8a                    	       	call   	       	delay1
                                           
                                           ;***********************************************
                                           ;IO设置
                                           ;***********************************************
                                           Io_init:
00056f   3cff     movai   0xff                    	       	movai  	       	0xff
000570   57ba     movra   0x1ba                   	       	movra  	       	LCDIOS1
000571   57bb     movra   0x1bb                   	       	movra  	       	LCDIOS2	       	       	;设置LCD驱动引脚,IO设为SEG2-SEG13
                                           
000572   3cf0     movai   0xf0                    	       	movai  	       	0xf0
000573   5791     movra   0x191                   	       	movra  	       	OEP0   	       	       	;P00-P03输入,P04-P07输出
000574   3cef     movai   0xef                    	       	movai  	       	0xef
000575   5790     movra   0x190                   	       	movra  	       	IOP0   	       	       	;P04输出低,P05-P07输出高
000576   3ceb     movai   0xeb                    	       	movai  	       	0xeb
000577   5792     movra   0x192                   	       	movra  	       	PUP0   	       	       	;P00,P01,P03上拉
000578   3cff     movai   0xff                    	       	movai  	       	0xff
000579   5795     movra   0x195                   	       	movra  	       	OEP1   	       	       	;P1全输出
                                           
00057a   3c00     movai   0                       	       	movai  	       	0x00
00057b   5796     movra   0x196                   	       	movra  	       	PUP1
00057c   579a     movra   0x19a                   	       	movra  	       	PUP2
00057d   579e     movra   0x19e                   	       	movra  	       	PUP3
                                           
00057e   5794     movra   0x194                   	       	movra  	       	IOP1   	       	       	;P1输出低
00057f   5798     movra   0x198                   	       	movra  	       	OEP2   	       	       	;P2全输入
000580   579c     movra   0x19c                   	       	movra  	       	OEP3           	       	;P3全输入
000581   5799     movra   0x199                   	       	movra  	       	IOP2
000582   579d     movra   0x19d                   	       	movra  	       	IOP3
                                           
                                           ;************************************************
                                           inte_init:
000583   3c00     movai   0                       	       	movai  	       	0x00
000584   5788     movra   0x188                   	       	movra  	       	MCR    	       	       	;下降沿触发,GIE=0
000585   3c84     movai   0x84                    	       	movai  	       	0x84
000586   57af     movra   0x1af                   	       	movra  	       	LVDCR  	       	       	;LVDEN=1,VBGSEL=1,比较电压LVDI输入
000587   3c45     movai   0x45                    	       	movai  	       	0x45
000588   578a     movra   0x18a                   	       	movra  	       	INTE   	       	       	;INT0IE=1,T0IE=1,ADIE=1
                                           
000589   778b     clrr    0x18b                   	       	clrr   	       	INTF
                                           
00058a   3c17     movai   0x17                    	       	movai  	       	0x17
00058b   57a0     movra   0x1a0                   	       	movra  	       	T0CR   	       	       	;T0未使能,选择低频时钟,128分频
                                           
00058c   3c55     movai   0x55                    	       	movai  	       	0x55
00058d   57a2     movra   0x1a2                   	       	movra  	       	T0LOAD
00058e   57a1     movra   0x1a1                   	       	movra  	       	T0CNT  	       	       	;T=(0X55+1)*128/32K=344ms
                                           
                                           ;***********************************************
                                           ;AD初始化
                                           ;***********************************************
                                           ad_init:
00058f   3cec     movai   0xec                    	       	movai  	       	0xec
000590   57b0     movra   0x1b0                   	       	movra  	       	ADCR0  	       	       	;CHOP打开,PGA打开,高频时钟64分频,使能ADC
000591   3c77     movai   0x77                    	       	movai  	       	0x77   	       	; AD速率//改37-77，降采样选择最高
000592   57b1     movra   0x1b1                   	       	movra  	       	ADCR1  	       	; 77=65536,128  57=16384,128  37=4096,128 采样一次32.768ms@8M?
000593   3cc0     movai   0xc0                    	       	movai  	       	0xc0
000594   57b2     movra   0x1b2                   	       	movra  	       	ADCR2  	       	       	;TADCINEN=1 ? TPGAOUTEN=1 ?
                                           
000595   3c82     movai   0x82                    	       	movai  	       	0x82
000596   57b8     movra   0x1b8                   	       	movra  	       	LCDCR0 	       	       	;开LCD
                                           
000597   3c2f     movai   0x2f                    	       	movai  	       	0x2f
000598   57b9     movra   0x1b9                   	       	movra  	       	LCDCR1 	       	       	;1/3DUTY,低频时钟
                                           
                                                  ;	       	movai  	       	0x60
                                                  ;	       	movra  	       	HIRCCR1	       	       	;高频时钟2M,8分频 似乎无效//改_删掉
000599   000e     clrwdt                          	       	CLRWDT
                                           
00059a   d2cc     bclr    0xcc, 0x1               	       	bclr   	       	AutoOn_Flags,WdtWaken_Flag
                                           
                                           ;..............................................
                                           ;清空RAM
                                           ;..............................................
00059b   3c00     movai   0                       	       	movai  	       	Buffer0
00059c   5784     movra   0x184                   	       	movra  	       	FSR0
                                           ClrRam:	       	       	       	       	       	       	;清零0X00-0X98
00059d   7780     clrr    0x180                   	       	clrr   	       	INDF0
00059e   6784     incr    0x184                   	       	incr   	       	FSR0
00059f   3c99     movai   0x99                    	       	movai  	       	0X99
0005a0   4984     rsubar  0x184                   	       	rsubar 	       	FSR0
0005a1   e187     jbset   0x187, 0                	       	jbset  	       	C
0005a2   a59d     goto    0x59d                   	       	goto   	       	ClrRam
0005a3   7684     clrr    0x84                    	       	clrr   	       	second
                                           
                                           ;************************************************
                                           ;默认数据
                                           ;************************************************
                                              	   	movfl  	       	CalCount1H, 01H
                                                  	       	movfl  	       	CalCount1L, 0F4H
                                           
                                           ;*************************************************
                                           ;读取BIE
                                           ;*************************************************
                                           IntReadBie:
0005a8   3c00     movai   0                       	       	movai  	       	0X00
0005a9   5788     movra   0x188                   	       	movra  	       	MCR    	       	       	;GIE=0
0005aa   3c00     movai   0                       	       	movai  	       	0x00
0005ab   57ae     movra   0x1ae                   	       	movra  	       	OSCM   	       	       	;系统高频工作,高/低频休眠停振
0005ac   3c78     movai   0x78                    	       	MOVAI  	       	0x78
0005ad   57b3     movra   0x1b3                   	       	movra  	       	TPSC   	       	       	;2.3V LDO打开,基准电压打开
0005ae   3c64     movai   0x64                    	       	movai  	       	0x64
0005af   57ad     movra   0x1ad                   	       	movra  	       	PUMP   	       	       	;开PUMP,选择高频时钟,烧录电压7.5V,电压受VCP_CAL控制,LCD电压2.6V
                                           
0005b0   3c0f     movai   0xf                     	       	movai  	       	0x0F
0005b1   5695     movra   0x95                    	       	movra  	       	REG3
0005b2   3c00     movai   0                       	       	movai  	       	0x00
0005b3   5784     movra   0x184                   	       	movra  	       	FSR0
0005b4   3c0f     movai   0xf                     	       	movai  	       	0x0F
0005b5   5785     movra   0x185                   	       	movra  	       	FSR1
                                           IntReadBie1:
0005b6   0000     nop                             	       	nop
0005b7   0000     nop                             	       	nop
0005b8   5989     movar   0x189                   	       	movar  	       	INDF3  	       	       	;起始地址0x0F00
0005b9   568e     movra   0x8e                    	       	movra  	       	CheckRam1
0005ba   5983     movar   0x183                   	       	movar  	       	HIBYTE
0005bb   568f     movra   0x8f                    	       	movra  	       	CheckRam2
0005bc   0000     nop                             	       	nop
0005bd   0000     nop                             	       	nop
0005be   6784     incr    0x184                   	       	incr   	       	FSR0
0005bf   5989     movar   0x189                   	       	movar  	       	INDF3
0005c0   5690     movra   0x90                    	       	movra  	       	CheckRam3
0005c1   5983     movar   0x183                   	       	movar  	       	HIBYTE
0005c2   5691     movra   0x91                    	       	movra  	       	CheckRam4
0005c3   0000     nop                             	       	nop
0005c4   0000     nop                             	       	nop
0005c5   6784     incr    0x184                   	       	incr   	       	FSR0
0005c6   5989     movar   0x189                   	       	movar  	       	INDF3
0005c7   5692     movra   0x92                    	       	movra  	       	CheckRam5
0005c8   5983     movar   0x183                   	       	movar  	       	HIBYTE
0005c9   5693     movra   0x93                    	       	movra  	       	CheckRam6
                                           
0005ca   3cff     movai   0xff                    	       	movai  	       	0FFH
0005cb   788e     andar   0x8e                    	       	ANDAR  	       	CheckRam1
0005cc   788f     andar   0x8f                    	       	ANDAR  	       	CheckRam2
0005cd   7890     andar   0x90                    	       	ANDAR  	       	CheckRam3
0005ce   7891     andar   0x91                    	       	ANDAR  	       	CheckRam4
0005cf   39ff     xorai   0xff                    	       	XORAI  	       	0FFH
0005d0   f587     jbclr   0x187, 0x2              	       	jbclr  	       	Z
0005d1   a5e4     goto    0x5e4                   	       	goto   	       	IntReadBie2    	       	;读出数据全FF
0005d2   0000     nop                             	       	nop
                                                  	       	movff  	       	CalDot1L,CheckRam1
                                                  	       	movff  	       	CalDot1H,CheckRam2
                                                  	       	movff  	       	CalDot2L,CheckRam3
                                                  	       	movff  	       	CalDot2H,CheckRam4
                                                  	       	movff  	       	CalDot3L,CheckRam5
                                                  	       	movff  	       	CalDot3H,CheckRam6
0005df   3c02     movai   0x2                     	       	movai  	       	0x02
0005e0   7f84     addra   0x184                   	       	ADDRA  	       	FSR0
0005e1   6a95     djzr    0x95                    	       	DJZR   	       	REG3
0005e2   a5b6     goto    0x5b6                   	       	goto   	       	IntReadBie1
0005e3   a5f7     goto    0x5f7                   	       	goto   	       	IntReadBie4    	       	;15次全有数据
                                           IntReadBie2:
0005e4   5c4b     orar    0x4b                    	       	ORAR   	       	CalDot1H
0005e5   5c4e     orar    0x4e                    	       	ORAR   	       	CalDot3L
0005e6   5c4f     orar    0x4f                    	       	ORAR   	       	CalDot3H
0005e7   3900     xorai   0                       	       	XORAI  	       	00H
0005e8   f587     jbclr   0x187, 0x2              	       	jbclr  	       	Z
0005e9   a5eb     goto    0x5eb                   	       	goto   	       	IntReadBie3	   	;1H\3L\3H数据为0
0005ea   a5f7     goto    0x5f7                   	       	goto   	       	IntReadBie4    	       	;
                                           IntReadBie3:
                                                  	       	movfl  	       	CalDot1L,2BH
                                                  	       	movfl  	       	CalDot1H,17H
                                                  	       	movfl  	       	CalDot2L,2BH
                                                  	       	movfl  	       	CalDot2H,2EH
                                                  	       	movfl  	       	CalDot3L,2BH
                                                  	       	movfl  	       	CalDot3H,46H
                                           IntReadBie4:
0005f7   0000     nop                             	       	nop
0005f8   0000     nop                             	       	nop
0005f9   3c30     movai   0x30                    	       	movai  	       	0x30
0005fa   57ae     movra   0x1ae                   	       	movra  	       	OSCM   	       	       	;系统高频工作,高/低频休眠停振
0005fb   3c61     movai   0x61                    	       	movai  	       	0x61
0005fc   57ad     movra   0x1ad                   	       	movra  	       	PUMP   	       	       	;开PUMP,选择高频时钟,烧录电压7.5V,电压受VLCDX控制,LCD电压3.2V
0005fd   3c81     movai   0x81                    	       	movai  	       	0x81
0005fe   5788     movra   0x188                   	       	movra  	       	MCR    	       	       	;INT0下降沿触发,GIE=1
0005ff   3c58     movai   0x58                	   	MOVAI  	       	0x58
000600   57b3     movra   0x1b3               	   	movra  	       	TPSC   	       	       	;打开LDO 2.5V,打开基准电压
000601   000e     clrwdt                      	   	CLRWDT
000602   c990     bset    0x190, 0x4          	   	bset   	       	IOP0,4 	       	       	;P04输出高
000603   3cff     movai   0xff                    	       	MOVAI  	       	0XFF
000604   000e     clrwdt                          	       	CLRWDT
000605   8483     call    0x483                   	       	CALL   	       	FullDspBuffer
000606   000e     clrwdt                          	       	CLRWDT
000607   848a     call    0x48a                   	       	CALL   	       	LoadDspData
000608   000e     clrwdt                          	       	CLRWDT
000609   3cff     movai   0xff                    	       	MOVAI  	       	0XFF
00060a   57ca     movra   0x1ca                   	       	movra           LCDDS8
00060b   57cb     movra   0x1cb                   	       	movra           LCDDS9
00060c   c1ca     bset    0x1ca, 0                	       	bset   	   	LCDDS8,0
00060d   c7c7     bset    0x1c7, 0x3              	       	bset   	   	LCDDS5,3
00060e   c683     bset    0x83, 0x3               	       	BSET   	       	SysFlag6,3
                                           
                                           ;**************************************************
                                           ;  BIE 读取数据
                                           ;**************************************************
                                           LoadBIEdata:
                                                  	       	movfl  	       	CalCount1H, 00H
                                                  	       	movfl  	       	CalCount1L, 07DH       	; 50kg
                                           
                                                  	       	movfl  	       	MaxCountH, 0X07
                                                  	       	movfl  	       	MaxCountL, 0X08	   	; 152.0 kg 超重
                                           
000617   f0cc     jbclr   0xcc, 0                 	       	jbclr  	       	AutoOn_Flags,WakenOn_Flag
000618   a61b     goto    0x61b                   	       	goto   	       	Start
                                                  	       	movfl  	       	UnitFlag, 00000001b    	;复位初始化,重量单位需恢复默认kg
                                           ;************************************************
                                           ;
                                           ;************************************************
                                           Start:
00061b   c215     bset    0x15, 0x1               	       	bset   	       	SysFlag1,AdcStartFlag
00061c   763c     clrr    0x3c                    	       	clrr   	       	SampleTimes
00061d   d415     bclr    0x15, 0x2               	       	bclr   	       	SysFlag1,AdcOkFlag
                                           
00061e   e0cc     jbset   0xcc, 0                 	       	jbset  	       	AutoOn_Flags,WakenOn_Flag
00061f   a625     goto    0x625                   	       	goto   	       	Init_Power
000620   d0cc     bclr    0xcc, 0                 	       	bclr   	       	AutoOn_Flags,WakenOn_Flag
                                                  	       	movfl  	       	Prog_Flow, 00001000B   	;开机显示中
                                                  	       	movfl  	       	T_Auto_Off, 12 	       	;movff     T_Auto_Off,T_WeightMode     	; 8秒关机时间
                                           
                                           ;**************************************************
                                           ;initialize some ram
                                           ;**************************************************
                                           Init_Power:
000625   763d     clrr    0x3d                    	       	clrr   	       	TBASE01S
000626   763e     clrr    0x3e                    	       	clrr   	       	TBASE05S
000627   000e     clrwdt                          	       	CLRWDT
                                           ;................................................
                                           
000628   d415     bclr    0x15, 0x2               	       	bclr   	       	SysFlag1,AdcOkFlag
000629   d615     bclr    0x15, 0x3               	       	bclr   	       	SysFlag1,DataOkFlag
00062a   d615     bclr    0x15, 0x3               	       	bclr   	       	SysFlag1,SteadyFlag
                                           
00062b   7666     clrr    0x66                    	       	clrr   	       	SysFlag4
00062c   766f     clrr    0x6f                    	       	clrr   	       	SysFlag5
                                           
00062d   7652     clrr    0x52                    	       	clrr   	       	CountH
00062e   7653     clrr    0x53                    	       	clrr   	       	CountL
00062f   7646     clrr    0x46                    	       	clrr   	       	StableCount
                                           
000630   f65f     jbclr   0x5f, 0x3               	       	jbclr  	       	Prog_Flow, 3
000631   a644     goto    0x644                   	       	goto   	       	MainLoop       	       	;开机显示中
                                           
000632   ee5a     jbset   0x5a, 0x7               	       	jbset  	       	Power_Flags,FlashZFlag
000633   0000     nop                             	       	nop
000634   0000     nop                             	       	nop
                                                  	       	movfl  	       	Prog_Flow, 00000010b   	;复位处理中
                                                  	       	movfl  	       	T_Auto_Off, 10 	       	; 最长5秒钟的刷新零点的时间
                                           Init_Power1:
                                           
                                           ;**************************************************
                                           ;开机归零程序
                                           ;**************************************************
                                           MainLoop1:
000639   e25f     jbset   0x5f, 0x1                        jbset           Prog_Flow, 1
00063a   a644     goto    0x644                            goto            MainLoop
                                           
00063b   e615     jbset   0x15, 0x3                        jbset           SysFlag1,SteadyFlag
00063c   a644     goto    0x644                            goto            MainLoop1End
                                           
00063d   80e0     call    0xe0                             call            GetZeroPoint   	       	; 刷新零点
00063e   810f     call    0x10f                            call            _GetAutoOnDC
                                                           movfl           Prog_Flow, 00001000B
000641   a644     goto    0x644                            goto            MainLoop
                                           
000642   7652     clrr    0x52                             clrr            CountH
000643   7653     clrr    0x53                             clrr            CountL
                                           MainLoop1End:
                                           
                                           MainLoop:
000644   f25f     jbclr   0x5f, 0x1               	       	jbclr  	       	Prog_Flow, 1
000645   a668     goto    0x668                   	       	goto   	       	Scankey_In
000646   e683     jbset   0x83, 0x3               	       	jbset  	       	SysFlag6,3
000647   a668     goto    0x668                   	       	goto   	       	Scankey_In
000648   d683     bclr    0x83, 0x3               	       	bclr   	       	SysFlag6,3
000649   0000     nop                             	       	nop
                                           Test_LowBat
00064a   3c32     movai   0x32                    	       	movai  	       	0x32
00064b   5694     movra   0x94                    	       	movra  	       	Lo_Counter
                                           Test_LowBat01
00064c   e1af     jbset   0x1af, 0                	       	jbset  	       	LVDCR,0
00064d   a668     goto    0x668                   	       	goto   	       	Scankey_In 	;0x066b
00064e   0000     nop                             	       	nop
00064f   0000     nop                             	       	nop
000650   0000     nop                             	       	nop
000651   6a94     djzr    0x94                    	       	djzr   	       	Lo_Counter
000652   a64c     goto    0x64c                   	       	goto   	       	Test_LowBat01  	;0x64f
000653   7611     clrr    0x11                    	       	clrr            Display2
000654   7610     clrr    0x10                    	       	clrr            Display1
000655   3c66     movai   0x66                    	       	movai  	       	01100110b      	       	;'o'
000656   5613     movra   0x13                    	       	movra  	       	Display4
000657   3c44     movai   0x44                    	       	movai  	       	01000100b      	       	;'L'
000658   5612     movra   0x12                    	       	movra  	       	Display3
000659   c990     bset    0x190, 0x4              	       	bset   	       	IOP0,4
00065a   839c     call    0x39c                   	       	call   	       	Lcd_Dis_Cal
00065b   3c02     movai   0x2                     	       	movai  	       	0x02
00065c   57c5     movra   0x1c5                   	       	movra           LCDDS3
00065d   808a     call    0x8a                    	       	call   	       	delay1
00065e   808a     call    0x8a                    	       	call   	       	delay1
00065f   808a     call    0x8a                    	       	call   	       	delay1
000660   808a     call    0x8a                    	       	call   	       	delay1
000661   808a     call    0x8a                    	       	call   	       	delay1
000662   808a     call    0x8a                    	       	call   	       	delay1
000663   808a     call    0x8a                    	       	call   	       	delay1
000664   808a     call    0x8a                    	       	call   	       	delay1
000665   808a     call    0x8a                    	       	call   	       	delay1
000666   808a     call    0x8a                    	       	call   	       	delay1
000667   a988     goto    0x988                   	       	goto            Sleep_In
                                           
                                                  	       	;#include      	"scankey.asm"
                                           Scankey_In:
000668   f190     jbclr   0x190, 0                	       	jbclr  	       	IOP0,0
000669   a66d     goto    0x66d                   	       	goto   	       	Main_Key
00066a   768d     clrr    0x8d                    	       	clrr   	       	second3	   	   	;P00输入低
00066b   c082     bset    0x82, 0                 	       	bset   	       	keycode,0
00066c   a673     goto    0x673                   	       	goto   	       	Key_Exit
                                           
                                           Main_Key:
00066d   768c     clrr    0x8c                    	       	clrr   	       	second2	   	   	;P00输入高(上拉)
00066e   e082     jbset   0x82, 0                 	       	jbset  	       	keycode,0
00066f   a673     goto    0x673                   	       	goto   	       	Key_Exit
                                           Unit_key:      	       	       	       	       	       	;按键弹起
000670   7682     clrr    0x82                    	       	clrr   	       	keycode
000671   c055     bset    0x55, 0                 	       	bset   	       	Key_Up, UnitKey
000672   668b     incr    0x8b                    	       	incr   	       	Key_Times
                                           
                                           Key_Exit:
                                                  	       	;#include      	"change.asm"
                                           ;**************************************************
                                           ;Function    :Get the unit
                                           ;Create Date :2012/5/17 16:03
                                           ;Create By   :Kevin Lee
                                           ;**************************************************
                                           _GetUnitAux:
000673   fe5f     jbclr   0x5f, 0x7               	       	jbclr  	       	Prog_Flow, 7   	       	; 7 校正   单位换算标志位的到来
000674   a68b     goto    0x68b                   	       	goto   	       	_GetUnitAuxEnd
                                           
                                           _GetUnitAuxKey:
000675   d06c     bclr    0x6c, 0                 	       	bclr   	       	Status_Flags,SWUnitFlag
000676   e055     jbset   0x55, 0                 	       	jbset  	       	Key_Up, UnitKey
000677   a68b     goto    0x68b                   	       	goto   	       	_GetUnitAuxEnd 	       	;无按键弹起动作
                                           
000678   7684     clrr    0x84                    	       	clrr   	       	second
                                                  	       	movfl  	       	T_Auto_Off, 12 	       	;movff 	T_Auto_Off,T_WeightMode
00067b   d055     bclr    0x55, 0                 	       	bclr   	       	Key_Up, UnitKey
00067c   d187     bclr    0x187, 0                	       	bclr   	       	PFALG, 0
00067d   52cd     rlr     0xcd                    	       	rlr    	       	UnitFlag
00067e   3c01     movai   0x1                     	       	movai  	       	00000001B
00067f   f6cd     jbclr   0xcd, 0x3               	       	jbclr  	       	UnitFlag, 3
000680   56cd     movra   0xcd                    	       	movra  	       	UnitFlag       	       	;0X01->0X02->0X04->0X08->0X01
000681   a68b     goto    0x68b                   	       	goto   	       	_GetUnitAuxEnd
                                           
                                           ;暂时不用
                                           _GetUnitAuxKey1:
000682   3c01     movai   0x1                     	       	movai  	       	00000001B
000683   f4cd     jbclr   0xcd, 0x2               	       	jbclr  	       	UnitFlag, 2
000684   56cd     movra   0xcd                    	       	movra  	       	UnitFlag
000685   a68b     goto    0x68b                   	       	goto   	       	_GetUnitAuxEnd
                                           
                                           Load_LB:
000686   3c02     movai   0x2                     	       	movai  	       	00000010B
000687   a689     goto    0x689                   	       	goto   	       	Load_Unit
                                           Load_ST:
000688   3c04     movai   0x4                     	       	movai  	       	00000100b
                                           Load_Unit:
000689   56cd     movra   0xcd                    	       	movra  	       	UnitFlag
00068a   c06c     bset    0x6c, 0                 	       	bset   	       	Status_Flags,SWUnitFlag
                                           _GetUnitAuxEnd:
                                                  	       	;#include      	"procadc.asm"
                                           ;************************************************
                                           ;Title  : Proc AD Sub 滑动平均
                                           ;Author : Kevin Lee
                                           ;Date   : 2008-6-26 20:22
                                           ;************************************************
                                           _ProcAdc:
00068b   e415     jbset   0x15, 0x2               	       	jbset  	       	SysFlag1,AdcOkFlag
00068c   a702     goto    0x702                   	       	goto   	       	ProcAdc_End
00068d   d415     bclr    0x15, 0x2                        bclr   	       	SysFlag1,AdcOkFlag
                                           
                                                  	       	movff  	       	TempRam1,H_DR
                                                  	       	movff  	       	TempRam2,M_DR
                                                  	       	movff  	       	TempRam3,L_DR
                                                  	       	movff  	       	TempRam4,H_DATA
                                                  	       	movff  	       	TempRam5,M_DATA
                                                  	       	movff  	       	TempRam6,L_DATA
00069a   8197     call    0x197                   	       	CALL   	       	_Sub3_3
                                           
00069b   760a     clrr    0xa                     	       	CLRR   	       	TempRam4
00069c   760b     clrr    0xb                     	       	CLRR   	       	TempRam5
                                                  	       	movfl  	       	TempRam6, 80   	; 波动范围
00069f   8197     call    0x197                   	       	CALL   	       	_Sub3_3	   	   	;(HML_DR - HML_DATA) - 80
0006a0   f187     jbclr   0x187, 0                	       	jbclr  	       	C
0006a1   a6d2     goto    0x6d2                   	       	goto   	       	Proc_Adc1
                                           _ProcAdc0: 	   	   	   	   	   	;(HML_DR - HML_DATA) < 80
                                                  	       	movff  	       	TempRam11,H_DATAC
                                                  	       	movff  	       	TempRam12,M_DATAC
                                                  	       	movff  	       	TempRam13,L_DATAC
                                           
0006a8   5824     movar   0x24                    	       	movar  	       	L_DATAB	   	; H_DATAC+差值
0006a9   5627     movra   0x27                    	       	movra  	       	L_DATAC
0006aa   7e0f     addra   0xf                     	       	ADDRA  	       	TempRam13
0006ab   5823     movar   0x23                    	       	movar  	       	M_DATAB
0006ac   5626     movra   0x26                    	       	movra  	       	M_DATAC
0006ad   120e     adcra   0xe                     	       	ADCRA  	       	TempRam12
0006ae   5822     movar   0x22                    	       	movar  	       	H_DATAB
0006af   5625     movra   0x25                    	       	movra  	       	H_DATAC
0006b0   120d     adcra   0xd                     	       	ADCRA  	       	TempRam11      	   	;TempRam11/12/13 = HML_DATAC + HML_DATAB ,HML_DATAB -> HML_DATAC
                                           ;...............
0006b1   5821     movar   0x21                             movar           L_DATAA
0006b2   5624     movra   0x24                             movra           L_DATAB
0006b3   7e0f     addra   0xf                              ADDRA           TempRam13
0006b4   5820     movar   0x20                             movar           M_DATAA
0006b5   5623     movra   0x23                             movra           M_DATAB
0006b6   120e     adcra   0xe                              ADCRA          	TempRam12
0006b7   581f     movar   0x1f                             movar           H_DATAA
0006b8   5622     movra   0x22                             movra           H_DATAB
0006b9   120d     adcra   0xd                              ADCRA          	TempRam11
                                           ;...............
0006ba   581e     movar   0x1e                             movar           L_DATA
0006bb   5621     movra   0x21                             movra           L_DATAA
0006bc   7e0f     addra   0xf                              ADDRA           TempRam13
0006bd   581d     movar   0x1d                             movar           M_DATA
0006be   5620     movra   0x20                             movra           M_DATAA
0006bf   120e     adcra   0xe                              ADCRA          	TempRam12
0006c0   581c     movar   0x1c                             movar           H_DATA
0006c1   561f     movra   0x1f                             movra           H_DATAA
0006c2   120d     adcra   0xd                              ADCRA          	TempRam11
                                           
0006c3   d187     bclr    0x187, 0                         bclr            C
0006c4   4e0d     rrr     0xd                              RRR             TempRam11
0006c5   4e0e     rrr     0xe                              RRR             TempRam12
0006c6   4e0f     rrr     0xf                              RRR             TempRam13
                                           
0006c7   d187     bclr    0x187, 0                         bclr            C
0006c8   4e0d     rrr     0xd                              RRR             TempRam11
0006c9   4e0e     rrr     0xe                              RRR             TempRam12
0006ca   4e0f     rrr     0xf                              RRR             TempRam13      	; 除以4取平均
                                           
                                                           movff           H_DR,TempRam11
                                                           movff           M_DR,TempRam12
                                                           movff           L_DR,TempRam13
0006d1   a6e1     goto    0x6e1                            goto            Proc_Adc2
                                           ;***************
                                           Proc_Adc1: 	   	   	   	   	   	;(HML_DR - HML_DATA) >= 80
0006d2   581c     movar   0x1c                             movar           H_DATA 	       	; 刷新
0006d3   5616     movra   0x16                             movra           H_DR
0006d4   561f     movra   0x1f                             movra           H_DATAA
0006d5   5622     movra   0x22                             movra           H_DATAB
0006d6   5625     movra   0x25                             movra           H_DATAC
                                           
0006d7   581d     movar   0x1d                             movar           M_DATA
0006d8   5617     movra   0x17                             movra           M_DR
0006d9   5620     movra   0x20                             movra           M_DATAA
0006da   5623     movra   0x23                             movra           M_DATAB
0006db   5626     movra   0x26                             movra           M_DATAC
                                           
0006dc   581e     movar   0x1e                             movar           L_DATA
0006dd   5618     movra   0x18                             movra           L_DR
0006de   5621     movra   0x21                             movra           L_DATAA
0006df   5624     movra   0x24                             movra           L_DATAB
0006e0   5627     movra   0x27                             movra           L_DATAC
                                           ;...............................
                                           Proc_Adc2: 	   	   	   	   	; 判断内码是否稳定
                                                           movff           TempRam4,H_DRBuf
                                                           movff           TempRam5,M_DRBuf
                                                           movff           TempRam6,L_DRBuf
                                           
0006e7   5816     movar   0x16                             movar           H_DR
0006e8   5619     movra   0x19                             movra           H_DRBuf
0006e9   5607     movra   0x7                              movra           TempRam1
                                           
0006ea   5817     movar   0x17                             movar           M_DR
0006eb   561a     movra   0x1a                             movra           M_DRBuf
0006ec   5608     movra   0x8                              movra           TempRam2
                                           
0006ed   5818     movar   0x18                             movar           L_DR
0006ee   561b     movra   0x1b                             movra           L_DRBuf
0006ef   5609     movra   0x9                              movra           TempRam3
                                           
0006f0   8197     call    0x197                            call            _Sub3_3
                                           
0006f1   760a     clrr    0xa                              clrr            TempRam4
0006f2   760b     clrr    0xb                              clrr            TempRam5
                                                           movfl           TempRam6, 3    	       	;movff          TempRam6,AdSteadyRange
                                           Proc_Adc2A:
0006f5   8197     call    0x197                            call            _Sub3_3
0006f6   f187     jbclr   0x187, 0                         jbclr           PFALG, 0
0006f7   a700     goto    0x700                            goto            Unstable
0006f8   6646     incr    0x46                             incr            StableCount
                                           
0006f9   3c05     movai   0x5                              movai           5      	       	       	;movar          AdsteadyTimes    ; 稳定次数
0006fa   4846     rsubar  0x46                             RSUBAR          StableCount
0006fb   e187     jbset   0x187, 0                         jbset           PFALG, 0
0006fc   a702     goto    0x702                            goto            ProcAdc_End
0006fd   6e46     decr    0x46                             DECR            StableCount
0006fe   c615     bset    0x15, 0x3                        BSET            SysFlag1,SteadyFlag
0006ff   a702     goto    0x702                            goto            ProcAdc_End
                                           ;...............................
                                           Unstable:
000700   7646     clrr    0x46                             clrr            StableCount
000701   d615     bclr    0x15, 0x3                        BCLR            SysFlag1,SteadyFlag
                                           ProcAdc_End:
000702   d2cc     bclr    0xcc, 0x1               	       	bclr            AutoOn_Flags,WdtWaken_Flag
000703   f25f     jbclr   0x5f, 0x1               	       	jbclr  	       	Prog_Flow, 1
000704   a709     goto    0x709                   	       	GOTO   	       	Close_End
                                           ;***********************************************
                                           ;8S没有重量变化自动关机
                                           Main_close:
000705   3cb9     movai   0xb9                             movai           0B9H
000706   0884     asubar  0x84                             ASUBAR          second 	       	       	;0XB9-SECOND
000707   e187     jbset   0x187, 0                         jbset           C
000708   a988     goto    0x988                            goto            Sleep_In       	       	;SECOND>0XB9
                                           
                                           Close_End:     	       	       	       	       	       	;时间未到
000709   3c2e     movai   0x2e                             movai           02EH
00070a   488d     rsubar  0x8d                             RSUBAR          second3	       	       	;SECOND3-0X2E
00070b   f187     jbclr   0x187, 0                         jbclr           C
00070c   768b     clrr    0x8b                            	clrr            Key_Times      	       	;SECOND3>=0X2E
                                           
00070d   3c03     movai   0x3                     	       	movai           03
00070e   488b     rsubar  0x8b                             RSUBAR          Key_Times      	       	;KEY_TIMES-03
00070f   e187     jbset   0x187, 0                         jbset           C
000710   a728     goto    0x728                   	        goto            Proc_EnterADCEnd   ;三短 KEY_TIMES<03
                                           
                                           Proc_EnterADC1:
000711   f190     jbclr   0x190, 0                	        jbclr  	       	IOP0,0
000712   a728     goto    0x728                   	       	goto   	       	Proc_EnterADCEnd   ;一长
                                           
000713   3c30     movai   0x30                    	       	movai  	       	0x30
000714   488c     rsubar  0x8c                    	       	RSUBAR         	second2
000715   e187     jbset   0x187, 0                	       	jbset  	       	PFALG, 0
000716   a728     goto    0x728                   	       	goto   	       	Proc_EnterADCEnd
000717   768c     clrr    0x8c                    	       	clrr   	       	second2
                                           
                                           Proc_EnterADCoK:
                                                           movfl           Prog_Flow, 10000000B
                                                           movfl           TF1, 00000010B
                                                           movfl           UnitFlag, 00000001b
                                           
00071e   765c     clrr    0x5c                             clrr            AmendZeroH
00071f   7671     clrr    0x71                             clrr            AmendZeroM
000720   765b     clrr    0x5b                             clrr            AmendZeroL
                                           
                                                           movff           TempRam11,H_DR
                                                           movff           TempRam12,M_DR
                                                           movff           TempRam13,L_DR
                                           
                                           EnterADC1:
000727   7657     clrr    0x57                    	       	clrr   	       	Timer1S
                                           
                                           Proc_EnterADCEnd:
                                           
                                           Main_Cal:
000728   e390     jbset   0x190, 0x1                       jbset           IOP0,1
000729   a988     goto    0x988                            goto            Sleep_In
                                           
00072a   ee5f     jbset   0x5f, 0x7                        jbset           Prog_Flow, 7
00072b   a8b0     goto    0x8b0                            goto            DisplayCount
                                                           ;#include         "Cal.asm"
                                           
                                           ;**************************************************
                                           ;Calibration program
                                           ;TF1     1显CAL    2 显零点内码      3第一校正点   4第二校正点
                                           ;**************************************************
                                           InterCode1:
00072c   7684     clrr    0x84                             clrr             second
00072d   000e     clrwdt                                   CLRWDT
00072e   e254     jbset   0x54, 0x1                        jbset           TF1, 1
00072f   a74d     goto    0x74d                            goto            ProcCal_0
000730   0000     nop                                      nop
000731   7684     clrr    0x84                             clrr             second
000732   3c03     movai   0x3                     	       	movai          00000011b
000733   5613     movra   0x13                             movra           Display4
000734   83fd     call    0x3fd                   	       	call           Lcd_Dis_Sys
000735   3c00     movai   0                                movai           00H
000736   57c2     movra   0x1c2                            movra           LCDDS0
000737   3c04     movai   0x4                              movai           04H
000738   57c3     movra   0x1c3                            movra           LCDDS1
000739   3c04     movai   0x4                              movai           04H
00073a   57c4     movra   0x1c4                            movra           LCDDS2
00073b   3c02     movai   0x2                              movai           02H
00073c   57c5     movra   0x1c5                            movra           LCDDS3
00073d   3c03     movai   0x3                              movai           03H
00073e   57c6     movra   0x1c6                            movra           LCDDS4
00073f   3c0f     movai   0xf                              movai           0FH
000740   57c7     movra   0x1c7                            movra           LCDDS5
000741   3c02     movai   0x2                              movai           02H
000742   57c8     movra   0x1c8                            movra           LCDDS6
000743   3c04     movai   0x4                              movai           04H
000744   57c9     movra   0x1c9                            movra           LCDDS7
000745   3c05     movai   0x5                     	       	movai           05H
000746   57ca     movra   0x1ca                            movra           LCDDS8
000747   3c02     movai   0x2                     	       	movai           02H
000748   57cb     movra   0x1cb                            movra           LCDDS9
000749   d615     bclr    0x15, 0x3               	       	bclr            SysFlag1,SteadyFlag
00074a   809a     call    0x9a                             call           delay2
                                           
                                           InterCode1A:
00074b   80f5     call    0xf5                             call            Change_F1                  ;转换校榜流程，改变TF1的值
00074c   a8af     goto    0x8af                            goto            ProcCalExit
                                           
                                           ;Calibration program
                                           ;***************
                                           ProcCal_0:
00074d   e454     jbset   0x54, 0x2                        jbset           TF1, 2
00074e   a757     goto    0x757                            goto            ProcCal_A
                                           
00074f   e615     jbset   0x15, 0x3                        jbset           SysFlag1,SteadyFlag
000750   a8af     goto    0x8af                            goto            ProcCalExit
                                           
000751   80e0     call    0xe0                             call            GetZeroPoint
000752   767b     clrr    0x7b                             clrr            displaycal1
000753   767c     clrr    0x7c                             clrr            displaycal2
000754   767d     clrr    0x7d                             clrr            displaycal3
000755   80f5     call    0xf5                             call            Change_F1
000756   a8af     goto    0x8af                            goto            ProcCalExit
                                           
                                           ;***************
                                           ProcCal_A:
000757   80e7     call    0xe7                             call            CurAD_ZeroAD
                                                           movff           displaycal1,TempRam1
                                                           movff           displaycal2,TempRam2
                                                           movff           displaycal3,TempRam3
00075e   e615     jbset   0x15, 0x3                        jbset           SysFlag1,SteadyFlag
00075f   a8af     goto    0x8af                            goto            ProcCalExit
                                           
000760   d615     bclr    0x15, 0x3                        bclr            SysFlag1,SteadyFlag
000761   7646     clrr    0x46                             clrr            StableCount
                                           
000762   80e7     call    0xe7                             call            CurAD_ZeroAD
                                           
                                                           movff           displaycal1,TempRam1
                                                           movff           displaycal2,TempRam2
                                                           movff           displaycal3,TempRam3
                                           
                                                           movff           CalDot3H,TempRam2             ; 当前内码与零点内码差值，暂存CalDot3H、CalDot3L
                                                           movff           CalDot3L,TempRam3
                                           ;..................................................
                                           
00076d   760a     clrr    0xa                              clrr            TempRam4
                                                           movfl           TempRam5, 01H
                                                           movfl           TempRam6, 090H                ; 1000个内码以下若稳定，都追零，方便同时标定多台秤
000772   8197     call    0x197                            call            _Sub3_3
000773   e187     jbset   0x187, 0                         jbset            C
000774   a7cc     goto    0x7cc                            goto            ProcCal_B
                                           
                                           
000775   e654     jbset   0x54, 0x3                        jbset           TF1, 3
000776   a77c     goto    0x77c                            goto            ProcCal_A1
                                                           movff           CalDot1H,CalDot3H
                                                           movff           CalDot1L,CalDot3L
00077b   a7d1     goto    0x7d1                            goto            ProcCalDot1
                                           ProcCal_A1:
00077c   e854     jbset   0x54, 0x4                        jbset           TF1, 4
00077d   a7a7     goto    0x7a7                            goto            ProcCal_A2
00077e   80e7     call    0xe7                             call            CurAD_ZeroAD
                                                           movff           displaycal1,TempRam1
                                                           movff           displaycal2,TempRam2
                                                           movff           displaycal3,TempRam3
                                                           movff           CalDot3H,TempRam2
                                                           movff           CalDot3L,TempRam3
                                           
000789   760a     clrr    0xa                              clrr            TempRam4
                                                           movfl           TempRam5, 0BH
                                                           movfl           TempRam6, 0B8H
00078e   8197     call    0x197                            call            _Sub3_3
00078f   e187     jbset   0x187, 0                         jbset            C
000790   a8af     goto    0x8af                            goto             ProcCalExit
                                                           movff           CalDot2H,CalDot3H
                                                           movff           CalDot2L,CalDot3L
                                           
                                                           movff           TempRam3,CalDot2H
                                                           movff           TempRam4,CalDot2L
                                           
                                                           movff           TempRam5,CalDot1H
                                                           movff           TempRam6,CalDot1L
00079d   8189     call    0x189                            CALL            _Sub2_2
00079e   e187     jbset   0x187, 0                         jbset           PFALG, 0
00079f   a8af     goto    0x8af                            goto             ProcCalExit
                                           
                                                           movfl           TempRam6,200      ;校正点2要比1大100才能通过
0007a2   760b     clrr    0xb                              clrr            TempRam5
0007a3   8189     call    0x189                            CALL            _Sub2_2
0007a4   e187     jbset   0x187, 0                         jbset           PFALG, 0
0007a5   a8af     goto    0x8af                            goto             ProcCalExit
0007a6   a7f6     goto    0x7f6                            goto            ProcCalDot2
                                           ProcCal_A2:
0007a7   80e7     call    0xe7                             call            CurAD_ZeroAD
                                                           movff           displaycal1,TempRam1
                                                           movff           displaycal2,TempRam2
                                                           movff           displaycal3,TempRam3
                                                           movff           CalDot3H,TempRam2
                                                           movff           CalDot3L,TempRam3
                                           
0007b2   760a     clrr    0xa                              clrr            TempRam4
                                                           movfl           TempRam5, 13H
                                                           movfl           TempRam6, 88H
0007b7   8197     call    0x197                            call            _Sub3_3
0007b8   e187     jbset   0x187, 0                         jbset            C
0007b9   a8af     goto    0x8af                            goto             ProcCalExit
                                           
                                                           movff           TempRam3,CalDot3H
                                                           movff           TempRam4,CalDot3L
                                           
                                                           movff           TempRam5,CalDot2H
                                                           movff           TempRam6,CalDot2L
0007c2   8189     call    0x189                            CALL            _Sub2_2
0007c3   e187     jbset   0x187, 0                         jbset           PFALG, 0
0007c4   a8af     goto    0x8af                            goto             ProcCalExit
                                           
                                                           movfl           TempRam6,200      ;校正点3要比2大100才能通过
0007c7   760b     clrr    0xb                              clrr            TempRam5
0007c8   8189     call    0x189                            CALL            _Sub2_2
0007c9   e187     jbset   0x187, 0                         jbset           PFALG, 0
0007ca   a8af     goto    0x8af                            goto             ProcCalExit
0007cb   a818     goto    0x818                            goto            ProcCalDot3
                                           ProcCal_B:
0007cc   80e0     call    0xe0                             call            GetZeroPoint
0007cd   767b     clrr    0x7b                             clrr            displaycal1
0007ce   767c     clrr    0x7c                             clrr            displaycal2
0007cf   767d     clrr    0x7d                             clrr            displaycal3
0007d0   a8af     goto    0x8af                            goto            ProcCalExit
                                           
                                           ;********第一点校正
                                           ProcCalDot1:
                                                           movff           TempRam3,CalDot1H
                                                           movff           TempRam4,CalDot1L
                                           
                                                           movff           TempRam5,CalCount1H
                                                           movff           TempRam6,CalCount1L                     ; CalDot1H-CalCount1H
                                           
                                           ProcCalDot1D:
0007d9   7684     clrr    0x84                             clrr             second
0007da   3c75     movai   0x75                    	       	movai           01110101b
0007db   5613     movra   0x13                             movra           Display4
0007dc   83fd     call    0x3fd                   	       	call           Lcd_Dis_Sys
0007dd   3c00     movai   0                                movai           00H
0007de   57c2     movra   0x1c2                            movra           LCDDS0
0007df   3c04     movai   0x4                              movai           04H
0007e0   57c3     movra   0x1c3                            movra           LCDDS1
0007e1   3c04     movai   0x4                              movai           04H
0007e2   57c4     movra   0x1c4                            movra           LCDDS2
0007e3   3c02     movai   0x2                              movai           02H
0007e4   57c5     movra   0x1c5                            movra           LCDDS3
0007e5   3c03     movai   0x3                              movai           03H
0007e6   57c6     movra   0x1c6                            movra           LCDDS4
0007e7   3c0f     movai   0xf                              movai           0FH
0007e8   57c7     movra   0x1c7                            movra           LCDDS5
0007e9   3c02     movai   0x2                              movai           02H
0007ea   57c8     movra   0x1c8                            movra           LCDDS6
0007eb   3c04     movai   0x4                              movai           04H
0007ec   57c9     movra   0x1c9                            movra           LCDDS7
0007ed   3c05     movai   0x5                     	       	movai           05H
0007ee   57ca     movra   0x1ca                            movra           LCDDS8
0007ef   3c02     movai   0x2                     	       	movai           02H
0007f0   57cb     movra   0x1cb                            movra           LCDDS9
0007f1   d615     bclr    0x15, 0x3               	       	bclr            SysFlag1,SteadyFlag
0007f2   809a     call    0x9a                             call           delay2
0007f3   d083     bclr    0x83, 0                          bclr            SysFlag6,Caldis
0007f4   80f5     call    0xf5                             call            Change_F1
0007f5   a8af     goto    0x8af                            goto            ProcCalExit
                                           
                                           ;********第二点校正
                                           ProcCalDot2:
                                                           movff           TempRam5,CalDot1H
                                                           movff           TempRam6,CalDot1L
0007fa   7684     clrr    0x84                              clrr             second
0007fb   3c37     movai   0x37                    	       	movai           00110111b
0007fc   5613     movra   0x13                             movra           Display4
0007fd   83fd     call    0x3fd                   	       	call           Lcd_Dis_Sys
0007fe   3c00     movai   0                                movai           00H
0007ff   57c2     movra   0x1c2                            movra           LCDDS0
000800   3c04     movai   0x4                              movai           04H
000801   57c3     movra   0x1c3                            movra           LCDDS1
000802   3c04     movai   0x4                              movai           04H
000803   57c4     movra   0x1c4                            movra           LCDDS2
000804   3c02     movai   0x2                              movai           02H
000805   57c5     movra   0x1c5                            movra           LCDDS3
000806   3c03     movai   0x3                              movai           03H
000807   57c6     movra   0x1c6                            movra           LCDDS4
000808   3c0f     movai   0xf                              movai           0FH
000809   57c7     movra   0x1c7                            movra           LCDDS5
00080a   3c02     movai   0x2                              movai           02H
00080b   57c8     movra   0x1c8                            movra           LCDDS6
00080c   3c04     movai   0x4                              movai           04H
00080d   57c9     movra   0x1c9                            movra           LCDDS7
00080e   3c05     movai   0x5                     	       	movai           05H
00080f   57ca     movra   0x1ca                            movra           LCDDS8
000810   3c02     movai   0x2                     	       	movai           02H
000811   57cb     movra   0x1cb                            movra           LCDDS9
000812   d615     bclr    0x15, 0x3               	       	bclr            SysFlag1,SteadyFlag
000813   809a     call    0x9a                             call           delay2
                                           
000814   c083     bset    0x83, 0                          bset             SysFlag6,Caldis
000815   d083     bclr    0x83, 0                          bclr             SysFlag6,Caldis
000816   80f5     call    0xf5                             call            Change_F1
000817   a8af     goto    0x8af                            goto            ProcCalExit
                                           
                                           ;********第三点校正
                                           ProcCalDot3:
000818   3c08     movai   0x8                              movai           00001000b
000819   565f     movra   0x5f                             movra           Prog_Flow
00081a   810f     call    0x10f                   	       	call            _GetAutoOnDC
00081b   a81c     goto    0x81c                            goto            SaveCalPoint
                                           
                                           ;*******************************
                                           SaveCalPoint:
00081c   000e     clrwdt                                  CLRWDT
00081d   3c00     movai   0                               movai          0x00
00081e   5788     movra   0x188                           movra          MCR
00081f   3c00     movai   0                               movai          0x00
000820   57ae     movra   0x1ae                           movra          OSCM
000821   3c78     movai   0x78                            MOVAI          0x78
000822   57b3     movra   0x1b3                           movra          TPSC
000823   3c64     movai   0x64                            movai          0x64
000824   57ad     movra   0x1ad                           movra          PUMP
                                           
                                           SaveCalPoint1R:
000825   3c0f     movai   0xf                       movai          0x0F                ;16次
000826   5695     movra   0x95                      movra          REG3
000827   3c00     movai   0                         movai          0x00
000828   5784     movra   0x184                     movra          FSR0
000829   3c0f     movai   0xf                       movai          0x0F
00082a   5785     movra   0x185                     movra          FSR1
                                           SaveCalPoint1RA:
00082b   8248     call    0x248                     call          ReadBie
00082c   f587     jbclr   0x187, 0x2                jbclr         Z
00082d   a833     goto    0x833                     goto          SaveCalPoint1RB
00082e   3c04     movai   0x4                     	       	 movai          0x04
                                           
00082f   7f84     addra   0x184                   	       	 ADDRA          FSR0
000830   6a95     djzr    0x95                    	       	 DJZR           REG3
000831   a82b     goto    0x82b                   	       	 goto           SaveCalPoint1RA
000832   a88e     goto    0x88e                   	       	 goto           CalErr1          ;标定次数满
                                           
                                           SaveCalPoint1RB:
000833   0000     nop                                     nop
000834   0000     nop                                     nop
000835   8260     call    0x260                           call     WriteBie
000836   a860     goto    0x860                           goto     IntReadBieA
                                           ;..................................................
                                           SaveCalPointOk:
000837   7684     clrr    0x84                    	       	clrr   	       	second
                                           
000838   3cb6     movai   0xb6                    	       	movai  	       	10110110b      	       	;'5'
000839   5613     movra   0x13                    	       	movra  	       	Display4
00083a   3cb6     movai   0xb6                    	       	movai  	       	10110110b      	       	;'5'
00083b   5612     movra   0x12                    	       	movra  	       	Display3
00083c   3cf3     movai   0xf3                    	       	movai  	       	11110011b      	       	;'A'
00083d   5611     movra   0x11                    	       	movra  	       	Display2
00083e   3cf1     movai   0xf1                    	       	movai  	       	11110001b      	       	;'P'
00083f   5610     movra   0x10                    	       	movra  	       	Display1
000840   839c     call    0x39c                   	       	call   	       	Lcd_Dis_Cal
000841   809a     call    0x9a                    	       	call   	       	delay2
000842   000e     clrwdt                          	       	CLRWDT
000843   808a     call    0x8a                    	       	call   	       	delay1
                                           
000844   3c31     movai   0x31                            movai       0x31
000845   57ae     movra   0x1ae                           movra       OSCM	       	       	       	;系统高频工作,高频一直开
000846   3c63     movai   0x63                            movai       0x63
000847   57ad     movra   0x1ad                           movra       PUMP	       	       	       	;开PUMP,选择高频时钟,烧录电压7.5V,电压受VLCDX控制,LCD电压3.0V
000848   3c81     movai   0x81                            movai       0x81
000849   5788     movra   0x188                           movra       MCR
00084a   c1ca     bset    0x1ca, 0                        bset        LCDDS8,0
00084b   c7c7     bset    0x1c7, 0x3                      bset        LCDDS5,3
00084c   3c58     movai   0x58                            MOVAI       0x58
00084d   57b3     movra   0x1b3                           movra       TPSC
                                           
00084e   3c37     movai   0x37                    	       	movai  	       	0x37
00084f   57b1     movra   0x1b1                   	       	movra  	       	ADCR1
                                           
                                                  	       	org    	0x853
                                           SaveCalPointOk1:
                                                                                            ; 1S
000853   808a     call    0x8a                             call    delay1
000854   000e     clrwdt                          	       	       	       	CLRWDT
000855   808a     call    0x8a                             call    delay1
000856   000e     clrwdt                                   CLRWDT
                                                           movfl           Prog_Flow, 00001000B
                                                           movfl           T_Auto_Off, 12                          ;movff          T_Auto_Off,T_WeightMode
00085b   c4cc     bset    0xcc, 0x2                        bset            AutoOn_Flags,DispOk_Flag
                                                           movfl           UnitFlag, 00000001B
00085e   d055     bclr    0x55, 0                          bclr            Key_Up, UnitKey
00085f   a644     goto    0x644                            goto            MainLoop
                                           
                                           ;校验
                                           
                                           ;**************************************************
                                           IntReadBieA:
                                           
                                           IntReadBieB:
000860   0000     nop                               nop
000861   0000     nop                               nop
000862   0000     nop                               nop
000863   5989     movar   0x189                     movar    INDF3
000864   5692     movra   0x92                      movra    CheckRam5
000865   5983     movar   0x183                     movar    HIBYTE
000866   5693     movra   0x93                      movra    CheckRam6
                                           
000867   0000     nop                               nop
000868   0000     nop                               nop
000869   6f84     decr    0x184                     DECR      FSR0
00086a   5989     movar   0x189                     movar     INDF3
00086b   5690     movra   0x90                      movra     CheckRam3
00086c   5983     movar   0x183                     movar     HIBYTE
00086d   5691     movra   0x91                      movra     CheckRam4
                                           
                                           
00086e   0000     nop                               nop
00086f   0000     nop                               nop
000870   6f84     decr    0x184                     DECR      FSR0
000871   5989     movar   0x189                     movar     INDF3
000872   568e     movra   0x8e                      movra     CheckRam1
000873   5983     movar   0x183                     movar     HIBYTE
000874   568f     movra   0x8f                      movra     CheckRam2
                                           
                                           
000875   584a     movar   0x4a                    	 movar       CalDot1L
000876   408e     xorar   0x8e                      XORAR       CheckRam1
000877   e587     jbset   0x187, 0x2              	 jbset       Z
000878   a899     goto    0x899                   	 goto        CalErr2
                                           
000879   584b     movar   0x4b                    	 movar       CalDot1H
00087a   408f     xorar   0x8f                      XORAR       CheckRam2
00087b   e587     jbset   0x187, 0x2              	 jbset       Z
00087c   a899     goto    0x899                   	 goto        CalErr2
                                           
00087d   584c     movar   0x4c                    	 movar       CalDot2L
00087e   4090     xorar   0x90                      XORAR       CheckRam3
00087f   e587     jbset   0x187, 0x2              	 jbset       Z
000880   a899     goto    0x899                   	 goto        CalErr2
                                           
000881   584d     movar   0x4d                    	 movar       CalDot2H
000882   4091     xorar   0x91                      XORAR       CheckRam4
000883   e587     jbset   0x187, 0x2              	 jbset       Z
000884   a899     goto    0x899                   	 goto        CalErr2
                                           
000885   584e     movar   0x4e                    	 movar       CalDot3L
000886   4092     xorar   0x92                      XORAR       CheckRam5
000887   e587     jbset   0x187, 0x2              	 jbset       Z
000888   a899     goto    0x899                   	 goto        CalErr2
                                           
000889   584f     movar   0x4f                      movar       CalDot3H
00088a   4093     xorar   0x93                      XORAR       CheckRam6
00088b   e587     jbset   0x187, 0x2              	 jbset       Z
00088c   a899     goto    0x899                   	 goto        CalErr2
00088d   a837     goto    0x837                   	 goto        SaveCalPointOk
                                           ;**************************************************
                                            ;标定次数满
                                           CalErr1:
00088e   000e     clrwdt                          	       	clrwdt
00088f   3c03     movai   0x3                     	       	movai  	       	00000011b
000890   5613     movra   0x13                    	       	movra  	       	Display4       	       	;'1'
000891   3c60     movai   0x60                    	       	movai  	       	01100000b
000892   5612     movra   0x12                    	       	movra  	       	Display3       	       	;'r'
000893   3c60     movai   0x60                    	       	movai  	       	01100000b
000894   5611     movra   0x11                    	       	movra  	       	Display2       	       	;'r'
000895   3cf4     movai   0xf4                    	       	movai  	       	11110100b
000896   5610     movra   0x10                    	       	movra  	       	Display1       	       	;'E'
000897   839c     call    0x39c                   	       	call   	       	Lcd_Dis_Cal
000898   a88e     goto    0x88e                   	       	goto   	       	CalErr1
                                           ;校验出错
                                           CalErr2:
000899   000e     clrwdt                          	       	clrwdt
00089a   3c75     movai   0x75                    	       	movai  	       	01110101b
00089b   5613     movra   0x13                    	       	movra  	       	Display4       	       	;'2'
00089c   3c60     movai   0x60                    	       	movai  	       	01100000b
00089d   5612     movra   0x12                    	       	movra  	       	Display3       	       	;'r'
00089e   3c60     movai   0x60                    	       	movai  	       	01100000b
00089f   5611     movra   0x11                    	       	movra  	       	Display2       	       	;'r'
0008a0   3cf4     movai   0xf4                    	       	movai  	       	11110100b
0008a1   5610     movra   0x10                    	       	movra  	       	Display1       	       	;'E'
0008a2   839c     call    0x39c                   	       	call   	       	Lcd_Dis_Cal
0008a3   a899     goto    0x899                   	       	goto   	       	CalErr2
                                           ;电压不稳
                                           CalErr3:
0008a4   000e     clrwdt                          	       	clrwdt
0008a5   3c37     movai   0x37                    	       	movai  	       	00110111b
0008a6   5613     movra   0x13                    	       	movra  	       	Display4       	       	;'3'
0008a7   3c60     movai   0x60                    	       	movai  	       	01100000b
0008a8   5612     movra   0x12                    	       	movra  	       	Display3       	       	;'r'
0008a9   3c60     movai   0x60                    	       	movai  	       	01100000b
0008aa   5611     movra   0x11                    	       	movra  	       	Display2       	       	;'r'
0008ab   3cf4     movai   0xf4                    	       	movai  	       	11110100b
0008ac   5610     movra   0x10                    	       	movra  	       	Display1       	       	;'E'
0008ad   839c     call    0x39c                   	       	call   	       	Lcd_Dis_Cal
0008ae   a8a4     goto    0x8a4                   	       	goto   	       	CalErr3
                                           ProcCalExit:
0008af   a929     goto    0x929                   	       	goto   	       	Display
                                           
                                           ;*************************************************
                                           DisplayCount:
0008b0   f25f     jbclr   0x5f, 0x1               	       	jbclr  	       	Prog_Flow, 1   	    ; 追零标志
0008b1   a639     goto    0x639                   	       	goto   	       	MainLoop1
                                           
0008b2   8285     call    0x285                   	       	call   	       	_GetCount
                                           
0008b3   fecc     jbclr   0xcc, 0x7               	       	jbclr           AutoOn_Flags,OverLoadFlag
0008b4   a8f9     goto    0x8f9                   	       	goto            MemCount_End
                                           
                                              	   	;#include  	"weight.asm"
                                                  	       	org    	   	0x8b5
                                           TrackZero_A:
0008b5   fc15     jbclr   0x15, 0x6                        jbclr           SysFlag1,NegFlag
0008b6   a8bd     goto    0x8bd                   	       	goto            TrackZero_B
0008b7   760b     clrr    0xb                              CLRR            TempRam5
                                                           movfl           TempRam6, 46   	   	;movff 	TempRam6,StartCount
                                           
0008ba   8189     call    0x189                            call            _Sub2_2
                                           
0008bb   f187     jbclr   0x187, 0                         jbclr           PFALG, 0
0008bc   a8d2     goto    0x8d2                            goto            NoTrackZero
                                           TrackZero_B:
0008bd   d483     bclr    0x83, 0x2                        bclr                SysFlag6,weight_have
0008be   ca15     bset    0x15, 0x5                        bset                SysFlag1,ZeroFlag
0008bf   dc15     bclr    0x15, 0x6                        bclr                SysFlag1,NegFlag
0008c0   dccc     bclr    0xcc, 0x6                        bclr                AutoOn_Flags,OnWeightFlag
0008c1   decc     bclr    0xcc, 0x7                        bclr                AutoOn_Flags,OverLoadFlag
0008c2   7652     clrr    0x52                             CLRR            CountH
0008c3   7653     clrr    0x53                             CLRR            CountL
                                           TrackZero_C:
0008c4   f615     jbclr   0x15, 0x3                        jbclr           SysFlag1,SteadyFlag
0008c5   a8cd     goto    0x8cd                            goto            TrackZero_E
0008c6   7667     clrr    0x67                             CLRR            TrackCount
0008c7   a8e9     goto    0x8e9                            goto            TrackZero_End
                                           TrackZero_D:
0008c8   6667     incr    0x67                             INCR            TrackCount
0008c9   3c02     movai   0x2                              movai           2  	;5              ;movfw 	TrackZeroTimes
                                           
0008ca   4867     rsubar  0x67                             RSUBAR          TrackCount
0008cb   e187     jbset   0x187, 0                         jbset           PFALG, 0
0008cc   a8e9     goto    0x8e9                            goto            TrackZero_End
                                           TrackZero_E:
0008cd   7667     clrr    0x67                             CLRR            TrackCount
                                           
0008ce   80e0     call    0xe0                             call            GetZeroPoint
                                           
0008cf   810f     call    0x10f                            call            _GetAutoOnDC
                                           
                                                           org    	0x8d0
0008d0   c856     bset    0x56, 0x4               	       	bset   	       	SysFlag3,4
0008d1   a8e9     goto    0x8e9                            goto            TrackZero_End
                                           
                                           ;************************************************
                                           NoTrackZero:
0008d2   7684     clrr    0x84                             CLRR            second
0008d3   c4cc     bset    0xcc, 0x2                        bset            AutoOn_Flags,DispOk_Flag
0008d4   7667     clrr    0x67                             CLRR            TrackCount
0008d5   c483     bset    0x83, 0x2                        bset            SysFlag6,weight_have
0008d6   fc15     jbclr   0x15, 0x6                        jbclr           SysFlag1,NegFlag           ;判断称重值是否为正值
0008d7   a8e9     goto    0x8e9                            goto            TrackZero_End
                                           
0008d8   ea15     jbset   0x15, 0x5                        jbset           SysFlag1,ZeroFlag         ; 解锁处理,注意：要重量重新回到零后有上升沿才能解锁
0008d9   a8e9     goto    0x8e9                            goto            TrackZero_End
                                           
                                                           movff           TempRam3,CountH
                                                           movff           TempRam4,CountL
0008de   760b     clrr    0xb                              CLRR            TempRam5
                                                           movfl           TempRam6, 20   	;movff 	TempRam6,StartCount    	; 上升沿解锁范围?(利用开机起磅重量)
                                           
0008e1   8189     call    0x189                            CALL            _Sub2_2
0008e2   e187     jbset   0x187, 0                         jbset            PFALG, 0
0008e3   a8e9     goto    0x8e9                            GOTO            TrackZero_End
                                           NoTrackZero4:
0008e4   d466     bclr    0x66, 0x2                        bclr            SysFlag4,LockFlag
0008e5   da15     bclr    0x15, 0x5                        bclr            SysFlag1,ZeroFlag
                                              	   	   	   	   	   	;bclr  	SysFlag2,GlintOpenFlag
                                           
0008e6   3c0c     movai   0xc                              movai           12
0008e7   eecc     jbset   0xcc, 0x7                        jbset           AutoOn_Flags,OverLoadFlag
0008e8   565e     movra   0x5e                             movra           T_Auto_Off     	;movff 	T_Auto_Off,T_WeightMode
                                           TrackZero_End:
                                           ;**************************************************
0008e9   f466     jbclr   0x66, 0x2                        jbclr           SysFlag4,LockFlag
0008ea   a924     goto    0x924                            goto            JudgeLock_End
                                           
                                           ;**************************************************
                                           MinusCount:
0008eb   d056     bclr    0x56, 0                          bclr            SysFlag3,DspNegFlag
                                           
0008ec   fc15     jbclr   0x15, 0x6                        jbclr           SysFlag1,NegFlag
0008ed   c056     bset    0x56, 0                          bset            SysFlag3,DspNegFlag                     ; 负重量显示标记
                                           MinusCount_End:
                                           ;**************************************************
                                           MemCount:
                                           
                                           ;..................................................
                                           MemCount4:
0008ee   8105     call    0x105                            call            Real_LockCount             ;Count-lockCount
0008ef   760b     clrr    0xb                              CLRR            TempRam5
                                                           movfl           TempRam6,05    	;movff 	TempRam6,MemRange
                                           
0008f2   8189     call    0x189                            CALL            _Sub2_2
0008f3   f187     jbclr   0x187, 0                         jbclr           PFALG, 0                   ;0在范围内,锁定
0008f4   a8f9     goto    0x8f9                            goto            MemCount_End
                                                           movff           CountH,LockCountH
                                                           movff           CountL,LockCountL
                                           MemCount_End:
                                           ;**************************************************
                                           JudgeOverWeight:
0008f9   decc     bclr    0xcc, 0x7                        bclr            AutoOn_Flags,OverLoadFlag
                                           
                                                           movff           TempRam3,MaxCountH
                                                           movff           TempRam4,MaxCountL
                                           
                                                           movff           TempRam5,CountH
                                                           movff           TempRam6,CountL
                                           ;                call            GetRealCount
                                           
                                                           org    	0x0902
000902   8189     call    0x189                            CALL            _Sub2_2
000903   f187     jbclr   0x187, 0                         jbclr            PFALG, 0
000904   a90f     goto    0x90f                   	       	goto             OverWeight_End
000905   cecc     bset    0xcc, 0x7                        bset            AutoOn_Flags,OverLoadFlag                       ; 超重
000906   3c37     movai   0x37                    	       	movai            00110111b     	       	;'3'
000907   5613     movra   0x13                             movra            Display4
000908   3c60     movai   0x60                             movai            01100000b     	       	;'r'
000909   5612     movra   0x12                             movra            Display3
00090a   3c60     movai   0x60                             movai            01100000b     	       	;'r'
00090b   5611     movra   0x11                             movra            Display2
00090c   3cf4     movai   0xf4                             movai            11110100b     	       	;'E'
00090d   5610     movra   0x10                             movra            Display1
00090e   839c     call    0x39c                            call             Lcd_Dis_Cal
                                                  	       	       	       	;goto             JudgeOverWeight
                                           OverWeight_End:
                                           ;==================================================
                                           JudgeLock:
00090f   e615     jbset   0x15, 0x3                        jbset           SysFlag1,SteadyFlag
000910   a924     goto    0x924                            GOTO            JudgeLock_End
                                           
000911   fc15     jbclr   0x15, 0x6                        jbclr           SysFlag1,NegFlag
000912   a924     goto    0x924                            GOTO            JudgeLock_End
                                           
000913   fa15     jbclr   0x15, 0x5                        jbclr           SysFlag1,ZeroFlag
000914   a924     goto    0x924                            GOTO            JudgeLock_End
                                           
000915   fecc     jbclr   0xcc, 0x7                        jbclr           AutoOn_Flags,OverLoadFlag
000916   a924     goto    0x924                            GOTO            JudgeLock_End
                                           
000917   da15     bclr    0x15, 0x5                        bclr                SysFlag1,ZeroFlag
000918   c466     bset    0x66, 0x2                        bset                SysFlag4,LockFlag
000919   cccc     bset    0xcc, 0x6                        bset                AutoOn_Flags,OnWeightFlag
                                                           movff           LockCountH,CountH
                                                           movff           LockCountL,CountL
                                           
00091e   7663     clrr    0x63                             CLRR            WTMemCount
                                           
00091f   c862     bset    0x62, 0x4                        bset            SysFlag2,GlintOpenFlag                  ; 允许进入中断处理闪烁的标志
000920   ca62     bset    0x62, 0x5                        bset                SysFlag2,GlintFlag                  ; 亮
000921   7684     clrr    0x84                    	       	       	       	CLRR            second
                                           
000922   7664     clrr    0x64                             CLRR            LCount
000923   7665     clrr    0x65                             CLRR            LLCount
                                           JudgeLock_End:
000924   760d     clrr    0xd                               clrr           TempRam11
                                                            movff           TempRam12,CountH     ;称重显示
                                                            movff           TempRam13,CountL
                                           
                                           Display:
                                           
000929   ee5f     jbset   0x5f, 0x7                        jbset           Prog_Flow, 7
00092a   a935     goto    0x935                            goto            Display_weightA
00092b   0000     nop                                      nop
                                           
                                                           movff           TempRam11,displaycal1
                                                           movff           TempRam12,displaycal2
                                                           movff           TempRam13,displaycal3
000932   f083     jbclr   0x83, 0                          jbclr           SysFlag6,Caldis
000933   a964     goto    0x964                            goto             Main_Hold
000934   a95e     goto    0x95e                            goto            Display_cal
                                            ;锁定显示
                                           Display_weightA:
000935   e466     jbset   0x66, 0x2                         jbset           SysFlag4,LockFlag
000936   a94c     goto    0x94c                             goto            Display_weightB
000937   0000     nop                                       nop
000938   000e     clrwdt                          	       	CLRWDT
                                           
                                                            movff           TempRam12,LockCountH                  ;重量锁定
                                                            movff           TempRam13,LockCountL
                                           
00093d   ea62     jbset   0x62, 0x5                         jbset           SysFlag2,GlintFlag                   ;中断闪烁亮
00093e   a94c     goto    0x94c                             goto            Display_weightB
00093f   e862     jbset   0x62, 0x4                         jbset           SysFlag2,GlintOpenFlag
000940   a94c     goto    0x94c                             goto            Display_weightB
000941   0000     nop                                       nop
000942   8481     call    0x481                             call            ClrLCDBuffer
000943   848a     call    0x48a                             call            LoadDspData   	       	;LCD 全灭
000944   84a4     call    0x4a4                             call            Lcd_Dis
000945   77c2     clrr    0x1c2                   	       	 clrr            LCDDS0
000946   77c5     clrr    0x1c5                   	       	 clrr            LCDDS3
000947   77c8     clrr    0x1c8                   	       	 clrr            LCDDS6
000948   77ca     clrr    0x1ca                   	       	 clrr            LCDDS8
000949   77cb     clrr    0x1cb                   	       	 clrr            LCDDS9
00094a   000e     clrwdt                                    CLRWDT
00094b   a644     goto    0x644                             goto            MainLoop
                                           
                                           
                                            ;称重显示
                                           Display_weightB:
00094c   fecc     jbclr   0xcc, 0x7                         jbclr           AutoOn_Flags,OverLoadFlag
00094d   a644     goto    0x644                             goto            MainLoop
00094e   0000     nop                                       nop
00094f   82f9     call    0x2f9                             call           Display_Weight
000950   8481     call    0x481                             call           ClrLCDBuffer
000951   84a4     call    0x4a4                   	       	 call           Lcd_Dis
000952   77c2     clrr    0x1c2                   	       	 clrr            LCDDS0
000953   77c5     clrr    0x1c5                   	       	 clrr            LCDDS3
000954   77c8     clrr    0x1c8                   	       	 clrr            LCDDS6
000955   77ca     clrr    0x1ca                   	       	 clrr            LCDDS8
000956   77cb     clrr    0x1cb                   	       	 clrr            LCDDS9
000957   8156     call    0x156                   	       	 call           Disp_To_Ram
000958   84a4     call    0x4a4                   	       	 call           Lcd_Dis
                                           
000959   f082     jbclr   0x82, 0                 	       	 jbclr           keycode,0
00095a   a644     goto    0x644                   	       	 goto            MainLoop
00095b   e483     jbset   0x83, 0x2               	       	 jbset           SysFlag6,weight_have
00095c   a964     goto    0x964                   	       	 goto            Main_Hold
00095d   a644     goto    0x644                   	       	 goto            MainLoop
                                           ;校正显示
                                           Display_cal:
                                           
00095e   8481     call    0x481                             call            ClrLCDBuffer
00095f   000e     clrwdt                                    CLRWDT
000960   8208     call    0x208                             call            _Ftob
000961   8464     call    0x464                             call            Display_Num
000962   839c     call    0x39c                   	       	 call            Lcd_Dis_Cal
000963   a644     goto    0x644                             goto            MainLoop
                                           Main_Hold:
000964   a644     goto    0x644                            goto              MainLoop
000965   c1ae     bset    0x1ae, 0                         bset             OSCM,0
000966   d3ae     bclr    0x1ae, 0x1                       bclr              OSCM,1
000967   d5ae     bclr    0x1ae, 0x2                       bclr              OSCM,2
                                           
000968   dfb0     bclr    0x1b0, 0x7                       bclr              ADCR0,7 ;关闭AD
000969   dbb0     bclr    0x1b0, 0x5                       bclr              ADCR0,5 ;关闭PGA
00096a   d9b3     bclr    0x1b3, 0x4                       bclr              TPSC,4  ;关闭LDO
00096b   3c00     movai   0                                movai             0x00
00096c   578b     movra   0x18b                            movra             INTF
00096d   cfa0     bset    0x1a0, 0x7                       bset              T0CR,7
00096e   000e     clrwdt                                   CLRWDT
00096f   0000     nop                                      NOP
000970   000b     stop                                     stop
000971   0000     nop                                      nop
000972   0000     nop                                      nop
000973   0000     nop                                      nop
                                           
000974   dfa0     bclr    0x1a0, 0x7                       bclr              T0CR,7
000975   c9b3     bset    0x1b3, 0x4                       bset              TPSC,4  ;开启LDO
000976   cbb0     bset    0x1b0, 0x5                       bset              ADCR0,5 ;开启PGA
000977   cfb0     bset    0x1b0, 0x7                       bset              ADCR0,7 ;开启AD
000978   cf88     bset    0x188, 0x7                       bset              MCR,7
000979   000e     clrwdt                                   CLRWDT
                                           wait_adif:
                                           
00097a   e190     jbset   0x190, 0                	       	jbset            IOP0,0
00097b   a984     goto    0x984                            goto              wait_end
00097c   ed8b     jbset   0x18b, 0x6                       jbset             ADIF
00097d   a97a     goto    0x97a                            goto              wait_adif
00097e   dd8b     bclr    0x18b, 0x6                       BCLR              INTF,6
                                           wait2_adif:
                                           
00097f   e190     jbset   0x190, 0                	       	jbset            IOP0,0
000980   a984     goto    0x984                            goto              wait_end
000981   ed8b     jbset   0x18b, 0x6                       jbset             ADIF
000982   a97f     goto    0x97f                            goto              wait2_adif
000983   dd8b     bclr    0x18b, 0x6                       BCLR              INTF,6
                                           wait_end:
000984   dd8b     bclr    0x18b, 0x6                       BCLR              INTF,6
000985   3c30     movai   0x30                             movai       0x30
000986   57ae     movra   0x1ae                            movra       OSCM
000987   a644     goto    0x644                            goto              MainLoop
                                           
                                           Sleep_In:
000988   810f     call    0x10f                   	       	call   	       	_GetAutoOnDC
                                                  	       	;#include      	"TurnOff.asm"
                                           ;*************************************************
                                           ;关机
                                           ;**********************************************
                                                  	       	org    	       	0x0989
                                           goto_allstop:
                                           
000989   dfb0     bclr    0x1b0, 0x7              	       	bclr   	       	ADCR0,7	       	       	;关ADC
                                           ;      	       	bclr   	       	LVDCR,7
00098a   3c2f     movai   0x2f                    	       	movai  	       	0x2F
00098b   57af     movra   0x1af                   	       	movra  	       	LVDCR  	       	       	;关LVD,比较电压2.4V
00098c   dbb0     bclr    0x1b0, 0x5              	       	bclr   	       	ADCR0,5	       	       	;关PGA
00098d   d9b3     bclr    0x1b3, 0x4              	       	bclr   	       	TPSC,4 	       	       	;关LDO
00098e   d7b3     bclr    0x1b3, 0x3              	       	bclr   	       	TPSC,3 	       	       	;关基准电压
00098f   dfa0     bclr    0x1a0, 0x7              	       	bclr   	       	T0CR,7 	       	       	;关T0
000990   dfa4     bclr    0x1a4, 0x7              	       	bclr   	       	T1CR,7 	       	       	;关T1
000991   3c00     movai   0                       	       	movai  	       	0x00
000992   57b3     movra   0x1b3                   	       	movra  	       	TPSC
000993   57b0     movra   0x1b0                   	       	movra  	       	ADCR0
000994   57b1     movra   0x1b1                   	       	movra  	       	ADCR1
000995   57bb     movra   0x1bb                   	       	movra  	       	LCDIOS2	       	       	;LCD引脚改为IO
000996   57ba     movra   0x1ba                   	       	movra  	       	LCDIOS1
                                           
                                           
000997   dfb8     bclr    0x1b8, 0x7              	       	bclr   	       	LCDCR0,7               	;关LCD
000998   ddad     bclr    0x1ad, 0x6              	       	bclr   	       	PUMP,6                 	;关PUMP
000999   d1ae     bclr    0x1ae, 0                	       	bclr   	       	OSCM,0 	       	       	;高频振荡器休眠时停振
00099a   c3ae     bset    0x1ae, 0x1              	       	bset   	       	OSCM,1 	       	       	;低频振荡器始终工作
00099b   c5ae     bset    0x1ae, 0x2              	       	bset   	       	OSCM,2 	       	       	;低频时钟作为系统时钟
                                           
00099c   3c00     movai   0                       	       	movai  	       	0x00
00099d   5796     movra   0x196                   	       	movra  	       	PUP1   	       	       	;P1上拉无效
00099e   579a     movra   0x19a                   	       	movra  	       	PUP2   	       	       	;P2上拉无效
00099f   579e     movra   0x19e                   	       	movra  	       	PUP3   	       	       	;P3上拉无效
0009a0   3c00     movai   0                       	       	movai  	       	0x00
0009a1   5794     movra   0x194                   	       	movra  	       	IOP1
0009a2   5799     movra   0x199                   	       	movra  	       	IOP2
0009a3   579d     movra   0x19d                   	       	movra  	       	IOP3
0009a4   3cff     movai   0xff                    	       	movai           0xFF
0009a5   5795     movra   0x195                   	       	movra  	       	OEP1   	       	       	;P1全输出低
0009a6   5798     movra   0x198                   	       	movra  	       	OEP2   	       	       	;P2全输出低
0009a7   579c     movra   0x19c                   	       	movra  	       	OEP3   	       	       	;P3全输出低
                                           
                                           goto_allstop1:
0009a8   3cfe     movai   0xfe                    	       	movai  	       	0xFE
0009a9   5791     movra   0x191                   	       	movra  	       	OEP0   	       	       	;p00 to input
0009aa   3c01     movai   0x1                     	       	movai  	       	0x01
0009ab   5790     movra   0x190                   	       	movra  	       	IOP0   	       	       	;P01-P07输出低
0009ac   3c01     movai   0x1                     	       	movai  	       	0x01
0009ad   5792     movra   0x192                   	       	movra  	       	PUP0   	       	       	;set p00 to pullup
                                           goto_allstop2:
0009ae   cf88     bset    0x188, 0x7              	       	bset   	       	MCR,7  	       	       	;GIE=1
0009af   3c04     movai   0x4                     	       	movai  	       	0x04
0009b0   578a     movra   0x18a                   	       	movra  	       	INTE   	       	       	;INT0IE=1
0009b1   778b     clrr    0x18b                   	       	clrr   	       	INTF
0009b2   000e     clrwdt                          	       	clrwdt
0009b3   0000     nop                             	       	NOP
                                           
0009b4   000b     stop                            	       	STOP   	       	       	       	       	;WDT能唤醒;INT0能唤醒进中断
0009b5   0000     nop                             	       	nop    	       	       	       	       	;唤醒后系统以低频工作
0009b6   0000     nop                             	       	nop
0009b7   0000     nop                             	       	nop
                                           
0009b8   c1ae     bset    0x1ae, 0                	       	bset   	       	OSCM,0 	       	       	;高频振荡器始终工作
0009b9   c3ae     bset    0x1ae, 0x1              	       	bset   	       	OSCM,1 	       	       	;低频振荡器始终工作
                                           
0009ba   fb88     jbclr   0x188, 0x5              	       	JBCLR  	       	MCR,5
0009bb   a514     goto    0x514                   	       	goto   	       	WDTWankenUp    	       	;发生WDT溢出
                                           
                                           ;*******************************
0009bc   778b     clrr    0x18b                   	       	clrr   	       	INTF
0009bd   778a     clrr    0x18a                   	       	clrr   	       	INTE
0009be   f190     jbclr   0x190, 0                	       	jbclr  	       	IOP0,0
0009bf   a9ae     goto    0x9ae                   	       	goto   	       	goto_allstop2
0009c0   0000     nop                             	       	nop
0009c1   0000     nop                             	       	nop
0009c2   0000     nop                             	       	nop
0009c3   0000     nop                             	       	nop
0009c4   3c20     movai   0x20                    	       	MOVAI  	       	0X20
0009c5   8178     call    0x178                   	       	CALL   	       	delay4
0009c6   f190     jbclr   0x190, 0                	       	jbclr  	       	IOP0,0
0009c7   a9ae     goto    0x9ae                   	       	goto   	       	goto_allstop2
0009c8   a566     goto    0x566                   	       	goto   	       	SysInit1
                                           
                                           ;**************************************************
                                           ;****************@@@@@@@@@@@@@@@@@@****************
                                           ;**************************************************
                                           
                                           ;...............................................
                                                  	       	end
                                           


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)

0000 : XXXXXXXX-------- XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0080 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
00C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0140 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0180 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
01C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0200 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0240 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0280 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
02C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0300 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0340 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0380 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
03C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0400 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0440 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0480 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
04C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0500 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0540 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0580 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
05C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0600 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0640 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0680 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
06C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0700 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0740 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0780 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
07C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0800 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0840 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0880 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
08C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0900 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0940 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0980 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
09C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0A00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0A40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0A80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0AC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0B00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0B40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0B80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0BC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0C00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0C40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0C80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0CC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0D00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0D40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0D80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0DC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0E00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0E40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0E80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0EC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0F00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0F40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0F80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0FC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1000 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1080 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX ------XXXXXXXXXX XXXXXXXXXXXXXXXX
10C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1140 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1180 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
11C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1200 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1240 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1280 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
12C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1300 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1340 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1380 : XXXXXXXXXXXXXXXX XX-------------- ---------------- ----------------

All other memory blocks unused.

Program Memory Words Used:  2498

